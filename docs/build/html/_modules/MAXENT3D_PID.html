

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MAXENT3D_PID &mdash; MAXENT3D_PID 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> MAXENT3D_PID
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../MAXENT3D_PID.html">MAXENT3D_PID Package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MAXENT3D_PID</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>MAXENT3D_PID</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for MAXENT3D_PID</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;MAXENT3D_PID.py -- Python module</span>

<span class="sd">MAXENT3D_PID: Trivariate Partial Information Decomposition via Maximum Entropy</span>
<span class="sd">https://github.com/Abzinger/MAXENT3D_PID </span>

<span class="sd">(c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">Permission to use and modify with proper attribution</span>
<span class="sd">(Apache License version 2.0)</span>

<span class="sd">Information about the algorithm, documentation, and examples are here:</span>
<span class="sd">@Article{?????????????,</span>

<span class="sd">          author =       {Makkeh, Abdullah and Theis, Dirk Oliver and Vicente, Raul and Chicharro, Daniel},</span>
<span class="sd">          title =        {????????},</span>
<span class="sd">          journal =      {????????},</span>
<span class="sd">          year =         ????,</span>
<span class="sd">          volume =    {??},</span>
<span class="sd">          number =    {?},</span>
<span class="sd">          pages =     {???}</span>
<span class="sd">}</span>

<span class="sd">Please cite this paper when you use this software (cf. README.md)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">TRIVARIATE_SYN</span>
<span class="kn">import</span> <span class="nn">TRIVARIATE_UNQ</span>
<span class="kn">import</span> <span class="nn">TRIVARIATE_QP</span>

<span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="k">import</span> <span class="n">Pool</span>
<span class="kn">import</span> <span class="nn">ecos</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">sparse</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">LA</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log2</span>
<span class="n">ln</span>  <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span>

<div class="viewcode-block" id="r_vidx"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.r_vidx">[docs]</a><span class="k">def</span> <span class="nf">r_vidx</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span></div>
<div class="viewcode-block" id="p_vidx"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.p_vidx">[docs]</a><span class="k">def</span> <span class="nf">p_vidx</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span></div>
<div class="viewcode-block" id="q_vidx"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.q_vidx">[docs]</a><span class="k">def</span> <span class="nf">q_vidx</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span></div>

<div class="viewcode-block" id="MAXENT3D_PID_Exception"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.MAXENT3D_PID_Exception">[docs]</a><span class="k">class</span> <span class="nc">MAXENT3D_PID_Exception</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prints exception when MAXENT3D_PID doesn&#39;t return a solution </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="Solve_w_ECOS"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Solve_w_ECOS">[docs]</a><span class="k">class</span> <span class="nc">Solve_w_ECOS</span><span class="p">():</span>

    <span class="sd">&quot;&quot;&quot;Solve_w_Ecos.</span>
<span class="sd">    </span>
<span class="sd">    (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">    Permission to use and modify under Apache License version 2.0</span>
<span class="sd">    Implements the ecos initialization and functions needed to be used </span>
<span class="sd">    by the children classes that computes PID terms  </span>
<span class="sd">    </span>
<span class="sd">    Methods:</span>
<span class="sd">      condentropy__orig(pdf, output)</span>
<span class="sd">               Computes H(T|X,Y,Z) w.r.t the original distribution P</span>
<span class="sd">      entropy_V(V,pdf,output)</span>
<span class="sd">          Computes H(T), H(X), H(Y), or H(Z) w.r.t the original distribution P</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">marg_tx</span><span class="p">,</span> <span class="n">marg_ty</span><span class="p">,</span> <span class="n">marg_tz</span><span class="p">,</span> <span class="n">marg_xy</span><span class="p">,</span> <span class="n">marg_xz</span><span class="p">,</span> <span class="n">marg_yz</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">        Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">        Args: </span>
<span class="sd">            marg_tx: dict() P(T,X)</span>
<span class="sd">            marg_ty: dict() P(T,Y)</span>
<span class="sd">            marg_tz: dict() P(T,Z)</span>
<span class="sd">            marg_xy: dict() P(X,Y)</span>
<span class="sd">            marg_xz: dict() P(X,Z)</span>
<span class="sd">            marg_yz: dict() P(Y,Z)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># ECOS parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ecos_kwargs</span>   <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>       <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Probability density funciton data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_tx</span>         <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">marg_tx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_ty</span>         <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">marg_ty</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_tz</span>         <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">marg_tz</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">b_xy</span>         <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">marg_xy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_xz</span>         <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">marg_xz</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_yz</span>         <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">marg_yz</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">T</span>            <span class="o">=</span><span class="nb">set</span><span class="p">([</span> <span class="n">t</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_tx</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">]</span>
                               <span class="o">+</span> <span class="p">[</span> <span class="n">t</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ty</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">]</span>
                               <span class="o">+</span> <span class="p">[</span> <span class="n">t</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">z</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_tz</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span>            <span class="o">=</span> <span class="nb">set</span><span class="p">(</span> <span class="p">[</span> <span class="n">x</span>  <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_tx</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y</span>            <span class="o">=</span> <span class="nb">set</span><span class="p">(</span> <span class="p">[</span> <span class="n">y</span>  <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ty</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Z</span>            <span class="o">=</span> <span class="nb">set</span><span class="p">(</span> <span class="p">[</span> <span class="n">z</span>  <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">z</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_tz</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idx_of_quad</span>  <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quad_of_idx</span>  <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Do stuff:</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_tx</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ty</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span><span class="p">:</span>
                                <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_tz</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">idx_of_quad</span><span class="p">[</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_of_idx</span> <span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">quad_of_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="p">)</span>
                                <span class="c1">#^ if</span>
                            <span class="c1">#^ for z</span>
                        <span class="c1">#^ if</span>
                    <span class="c1">#^ for y</span>
                <span class="c1">#^ if</span>
            <span class="c1">#^ for x</span>
        <span class="c1">#^ for t</span>
    <span class="c1">#^ init()</span>

<div class="viewcode-block" id="Solve_w_ECOS.condentropy__orig"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Solve_w_ECOS.condentropy__orig">[docs]</a>    <span class="k">def</span> <span class="nf">condentropy__orig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">pdf</span><span class="p">,</span><span class="n">output</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;Computes H(T|X,Y,Z) w.r.t. the original distribution P of (T,X,Y,Z)</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             pdf: dict - the original distribution of (T,X,Y,Z)</span>
<span class="sd">                    Keys: (t,x,y,z)</span>
<span class="sd">                    values: P(t,x,y,z)</span>

<span class="sd">             output: int - print different outputs based on (int) to console</span>

<span class="sd">        Returns: </span>
<span class="sd">            mysum: float - H(T|X,Y,Z)        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">itic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="n">mysum</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">marg_xyz</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
            <span class="n">marg_xyz</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="o">+=</span> <span class="n">pdf</span><span class="p">[(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)]</span>
        <span class="c1">#^ for</span>
        
        <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)]</span>
            <span class="n">mysum</span> <span class="o">-=</span> <span class="n">p</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="n">marg_xyz</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>
        <span class="c1">#^ for</span>
        <span class="n">itoc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.condentropy__orig(): Time to compute H(T|XYZ) of the input pdf:&quot;</span><span class="p">,</span> <span class="n">itoc</span> <span class="o">-</span> <span class="n">itic</span><span class="p">,</span> <span class="s2">&quot;secs&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mysum</span></div>
    <span class="c1">#^ condentropy__orig()</span>

    <span class="c1"># Compute H(T), H(X), H(Y), or H(Z)</span>
<div class="viewcode-block" id="Solve_w_ECOS.entropy_V"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Solve_w_ECOS.entropy_V">[docs]</a>    <span class="k">def</span> <span class="nf">entropy_V</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes H(T), H(X), H(Y), or H(Z) w.r.t. the original </span>
<span class="sd">           distribution P of (T,X,Y,Z)</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             V: int -  if 1 computes  H(T) </span>
<span class="sd">                       if 2 computes  H(X) </span>
<span class="sd">                       if 3 computes  H(Y) </span>
<span class="sd">                       if 4 computes  H(Z) </span>
<span class="sd">             pdf: dict - the input distribution of (T,X,Y,Z)</span>
<span class="sd">                    Keys: (t,x,y,z)</span>
<span class="sd">                    values: P(t,x,y,z)</span>

<span class="sd">             output: int - print different outputs based on (int) to console</span>

<span class="sd">        Returns: </span>
<span class="sd">            (if 1: V=T | if 2: V=X | if 3: V=Y | if 4: V=Z)</span>
<span class="sd">            mysum: float - H(V)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">marg_V</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">num_V</span>  <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.</span><span class="p">)</span> 
        <span class="n">mysum</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">if</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># H(S)</span>
            <span class="n">itic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">marg_V</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
                    <span class="n">num_V</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1">#^ if </span>
            <span class="c1">#^ for</span>

            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">num_V</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">mysum</span> <span class="o">-=</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="p">)</span>
            <span class="c1">#^ for</span>
            <span class="n">itoc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.entopry_V(): Time to compute H(T):&quot;</span><span class="p">,</span> <span class="n">itoc</span> <span class="o">-</span> <span class="n">itic</span><span class="p">,</span> <span class="s2">&quot;secs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">mysum</span>

        <span class="k">elif</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># H(X)</span>
            <span class="n">itic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
                    <span class="n">num_V</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1">#^ if </span>
            <span class="c1">#^ for</span>

            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">num_V</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">mysum</span> <span class="o">-=</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="p">)</span>
            <span class="c1">#^ for</span>
            <span class="n">itoc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.entropy_V(): Time to compute H(X):&quot;</span><span class="p">,</span> <span class="n">itoc</span> <span class="o">-</span> <span class="n">itic</span><span class="p">,</span> <span class="s2">&quot;secs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">mysum</span>

        <span class="k">elif</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># H(Y)</span>
            <span class="n">itic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">marg_V</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
                    <span class="n">num_V</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1">#^ if </span>
            <span class="c1">#^ for</span>

            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">num_V</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">mysum</span> <span class="o">-=</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="p">)</span>
            <span class="c1">#^ for</span>
            <span class="n">itoc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.entropy_V(): Time to compute H(Y):&quot;</span><span class="p">,</span> <span class="n">itoc</span> <span class="o">-</span> <span class="n">itic</span><span class="p">,</span> <span class="s2">&quot;secs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">mysum</span>

        <span class="k">elif</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="c1"># H(Z)</span>
            <span class="n">itic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">marg_V</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
                    <span class="n">num_V</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1">#^ if </span>
            <span class="c1">#^ for</span>

            <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">num_V</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">mysum</span> <span class="o">-=</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">z</span><span class="p">]</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="p">)</span>
            <span class="c1">#^ for</span>
            <span class="n">itoc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.entropy_V(): Time to compute H(Z):&quot;</span><span class="p">,</span> <span class="n">itoc</span> <span class="o">-</span> <span class="n">itic</span><span class="p">,</span> <span class="s2">&quot;secs&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">mysum</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.entropy_V(): The argument V takes the values: 1, 2, 3, or 4&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div></div>
    <span class="c1">#^ entropy()</span>

<span class="c1">#^ class Solve_w_ECOS</span>



<div class="viewcode-block" id="Opt_I"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_I">[docs]</a><span class="k">class</span> <span class="nc">Opt_I</span><span class="p">(</span><span class="n">Solve_w_ECOS</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Implements the functions to compute Synergistic information ( CI(T;X,Y,Z )</span>
<span class="sd">    (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">    Permission to use and modify under Apache License version 2.0</span>

<span class="sd">    Methods:</span>
<span class="sd">       create_model(output)</span>
<span class="sd">          Creates the exponential Cone Program min_{Delta_p}H(T|X,Y,Z)</span>
<span class="sd">       solve(c,G,h,dims,A,b,output)</span>
<span class="sd">          Solves the exponential Cone Program min_{Delta_p}H(T|X,Y,Z)</span>
<span class="sd">       dual_value(sol_lambda,b)</span>
<span class="sd">          evaluates the dual value of H(T|X,Y,Z)</span>
<span class="sd">       check_feasibility(sol_rpq,sol_lambda,output)</span>
<span class="sd">          Checks the KKT conditions of the exponential Cone Program min_{Delta_p}H(T|X,Y,Z)</span>
<span class="sd">       condentropy(sol_rpq,output)</span>
<span class="sd">          evalutes the value of H(T|X,Y,Z) at the optimal distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Opt_I.create_model"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_I.create_model">[docs]</a>    <span class="k">def</span> <span class="nf">create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates the exponential Cone Program min_{q in Delta_d}H(T|X,Y,Z)</span>
<span class="sd">           of the form </span>
<span class="sd">              min. c&#39;x</span>
<span class="sd">              s.t.</span>

<span class="sd">                  Ax = b</span>
<span class="sd">                  Gx &lt;=_K h</span>

<span class="sd">             where </span>

<span class="sd">                   x = (r,p,q)</span>
<span class="sd">                   K represents a vector representing cones (K_1, K_2)</span>
<span class="sd">                   such that K_1 is a vector repesenting exponential cones </span>
<span class="sd">                   K_2 is a vector repesenting nonnegative cones </span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             output:</span>
<span class="sd">        Returns: </span>
<span class="sd">            c: numpy.array - objective function weights</span>
<span class="sd">            G: scipy.sparse.csc_matrix - matrix of exponential and nonnegative </span>
<span class="sd">            inequalities</span>
<span class="sd">            h: numpy.array - L.H.S. of inequalities </span>
<span class="sd">            dims: dictionary -  cones to be used </span>

<span class="sd">                keys: string - cone type (exponential or nonegative)</span>
<span class="sd">                values: int - number of cones</span>

<span class="sd">            A: scipy.sparse.csc_matrix - Matrix of marginal, q-w coupling, and </span>
<span class="sd">            q-p coupling equations </span>
<span class="sd">            b: numpy.array - L.H.S. of equalities </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="n">TRIVARIATE_SYN</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Opt_I.solve"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_I.solve">[docs]</a>    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Solves the exponential Cone Program min_{Delta_p}H(T|X,Y,Z)</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            c: numpy.array - objective function weights</span>
<span class="sd">            G: scipy.sparse.csc_matrix - matrix of exponential and nonnegative </span>
<span class="sd">            inequalities</span>
<span class="sd">            h: numpy.array - L.H.S. of inequalities </span>
<span class="sd">            dims: dictionary -  cones to be used </span>

<span class="sd">                    keys: string - cone type (exponential or nonegative)</span>
<span class="sd">                    values: int - number of cones</span>

<span class="sd">            A: scipy.sparse.csc_matrix - Matrix of marginal, q-w coupling, and </span>
<span class="sd">            q-p coupling equations </span>
<span class="sd">            b: numpy.array - L.H.S. of equalities </span>
<span class="sd">            output: int - print different outputs based on (int) to console</span>
<span class="sd"> </span>
<span class="sd">       Returns: </span>
<span class="sd">            sol_rpq:    numpy.array - primal optimal solution</span>
<span class="sd">            sol_slack:  numpy.array - slack of primal optimal solution (G*sol_rpq - h)</span>
<span class="sd">            sol_lambda: numpy.array - equalities dual optimal solution</span>
<span class="sd">            sol_mu:     numpy.array - inequalities dual  optimal solution   </span>
<span class="sd">            sol_info:   dictionary - Brief stats of the optimization from ECOS</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">TRIVARIATE_SYN</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Opt_I.dual_value"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_I.dual_value">[docs]</a>    <span class="k">def</span> <span class="nf">dual_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; evaluates the dual value of H(T|X,Y,Z)</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             sol_lambda: numpy.array - equalities dual optimal solution</span>
<span class="sd">             b: numpy.array - L.H.S. of equalities </span>
<span class="sd">        </span>
<span class="sd">        Returns: </span>
<span class="sd">            float </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">TRIVARIATE_SYN</span><span class="o">.</span><span class="n">dual_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="Opt_I.check_feasibility"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_I.check_feasibility">[docs]</a>    <span class="k">def</span> <span class="nf">check_feasibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_rpq</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Checks the KKT conditions of the exponential Cone Program min_{Delta_p}H(T|X,Y,Z)</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             sol_rpq:    numpy.array - primal optimal solution</span>
<span class="sd">             sol_slack:  numpy.array - slack of primal optimal solution (G*sol_rpq - h)</span>
<span class="sd">             sol_lambda: numpy.array - equalities dual optimal solution</span>
<span class="sd">             output: int - print different outputs based on (int) to console</span>

<span class="sd">        Returns: </span>
<span class="sd">             primal_infeasability: float - maximum violation of the optimal primal solution</span>
<span class="sd">             for primal equalities and inequalities</span>
<span class="sd">             dual_infeasability:   float - maximum violation of the optimal dual solution</span>
<span class="sd">             for dual equalities and inequalities</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">TRIVARIATE_SYN</span><span class="o">.</span><span class="n">check_feasibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_rpq</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Opt_I.condentropy"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_I.condentropy">[docs]</a>    <span class="k">def</span> <span class="nf">condentropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_rpq</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; evalutes the value of H(T|X,Y,Z) at the optimal distribution</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             sol_rpq: numpy.array - primal optimal solution</span>
<span class="sd">             output:  int - print different outputs based on (int) to console</span>
<span class="sd">        </span>
<span class="sd">        Returns: </span>
<span class="sd">            mysum: float - H(T|X,Y,Z)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">TRIVARIATE_SYN</span><span class="o">.</span><span class="n">condentropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_rpq</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span></div></div>
<span class="c1">#^ subclass Opt_I</span>

<span class="c1"># Subclass to compute Unique Information </span>
<div class="viewcode-block" id="Opt_II"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_II">[docs]</a><span class="k">class</span> <span class="nc">Opt_II</span><span class="p">(</span><span class="n">Solve_w_ECOS</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Implements the functions to compute Unique information</span>
<span class="sd">    (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">    Permission to use and modify under Apache License version 2.0</span>
<span class="sd">    </span>
<span class="sd">    Methods:</span>
<span class="sd">       initialization(which_sources)</span>
<span class="sd">          Initialize the data for the triplets (T,U,V) where U,V in {X,Y,Z}</span>
<span class="sd">       sq_vidx(i,which_sources)</span>
<span class="sd">          Computes the index of the optimal distribution (q_vars) in sol_rpq</span>
<span class="sd">       marginals(which_sources,sol_rpq,output)</span>
<span class="sd">          Computes all the marginal distributions of the optimal distribution</span>
<span class="sd">       create_model(which_sources,output)</span>
<span class="sd">          Creates the exponential Cone Program min_{Delta_p}H(T|U,V) where U,V in {X,Y,Z}</span>
<span class="sd">       solve(c,G,h,dims,A,b,output)</span>
<span class="sd">          Solves the exponential Cone Program min_{Delta_p}H(T|U,V) where U,V in {X,Y,Z}</span>
<span class="sd">       dual_value(sol_lambda,b)</span>
<span class="sd">          Evaluates the dual value of H(T|U,V) where U,V in {X,Y,Z}</span>
<span class="sd">       check_feasibility(which_sources, sol_rpq, sol_slack, sol_lambda, sol_mu, output)</span>
<span class="sd">          Checks the KKT conditions of the exponential Cone Program min_{Delta_p}H(T|U,V) </span>
<span class="sd">          where U,V in {X,Y,Z}</span>
<span class="sd">       condentropy_2vars(which_sources,sol_rpq,output,marg_XY,marg_XZ,marg_YZ,marg_SXY,marg_SXZ,marg_SYZ)</span>
<span class="sd">          Evalutes the value of H(T|U,V) w.r.t. the optimal distribution where U,V in {X,Y,Z}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Opt_II.initialization"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_II.initialization">[docs]</a>    <span class="k">def</span> <span class="nf">initialization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the data for the triplets (T,V,W) where V,W in {X,Y,Z}</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             which_sources: [1,2] if sources are X and Y </span>
<span class="sd">                            [1,3] if sources are X and Z</span>
<span class="sd">                            [2,3] if sources are Y and Z</span>

<span class="sd">        Returns: </span>
<span class="sd">            (if [1,2] v,w=x,y|if [1,3] v,w=x,z|if [2,3] v,w=y,z|)</span>
<span class="sd">            dictionary</span>

<span class="sd">              keys: (t,v,w)</span>
<span class="sd">              values: their indices </span>

<span class="sd">            list of (t,v,w)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">TRIVARIATE_UNQ</span><span class="o">.</span><span class="n">initialization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">)</span></div>

<div class="viewcode-block" id="Opt_II.sq_vidx"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_II.sq_vidx">[docs]</a>    <span class="k">def</span> <span class="nf">sq_vidx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the index of the optimal distribution (q_vars) in the</span>
<span class="sd">           optimal solution of the Exponential Cone Programming</span>

<span class="sd">        Args:</span>
<span class="sd">             i: int</span>
<span class="sd">             which_sources: [1,2] if sources are X and Y </span>
<span class="sd">                            [1,3] if sources are X and Z</span>
<span class="sd">                            [2,3] if sources are Y and Z</span>
<span class="sd">        Returns:</span>
<span class="sd">            int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">TRIVARIATE_UNQ</span><span class="o">.</span><span class="n">sq_vidx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">)</span></div>

<div class="viewcode-block" id="Opt_II.marginals"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_II.marginals">[docs]</a>    <span class="k">def</span> <span class="nf">marginals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">,</span> <span class="n">sol_rpq</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes all the marginal distributions of the optimal distribution</span>

<span class="sd">        Args:</span>
<span class="sd">             which_sources: [1,2] if sources are X and Y and Q is the optimal</span>
<span class="sd">                            distribution of min_{Delta_P} H(T|X,Y)</span>
<span class="sd">                            [1,3] if sources are X and Z and Q is the optimal</span>
<span class="sd">                            distribution of min_{Delta_P} H(T|X,Z)</span>
<span class="sd">                            [2,3] if sources are Y and Z and Q is the optimal</span>
<span class="sd">                            distribution of min_{Delta_P} H(T|Y,Z)</span>

<span class="sd">             sol_rpq: numpy.array - array of triplets (r,p,q) of Exponential cone</span>
<span class="sd">             where q is the optimal distribution</span>
<span class="sd">             output: int - print different outputs based on (int) to console</span>
<span class="sd">             </span>
<span class="sd">        Returns: </span>
<span class="sd">            dictionary - optimal marginal distribution of T</span>

<span class="sd">              keys: t</span>
<span class="sd">              values: Q(t)</span>

<span class="sd">            dictionary - optimal marginal distribution of X</span>

<span class="sd">              keys: x</span>
<span class="sd">              values: Q(x)</span>

<span class="sd">            dictionary - optimal marginal distribution of Y</span>

<span class="sd">              keys: y</span>
<span class="sd">              values: Q(y)</span>

<span class="sd">            dictionary - optimal marginal distribution of Z</span>

<span class="sd">              keys: z</span>
<span class="sd">              values: Q(z)</span>

<span class="sd">            dictionary - optimal marginal distribution of (T,X)</span>

<span class="sd">              keys: t,x</span>
<span class="sd">              values: Q(t,x)</span>

<span class="sd">            dictionary - optimal marginal distribution of (T,Y)</span>

<span class="sd">              keys: t,y</span>
<span class="sd">              values: Q(t,y)</span>

<span class="sd">            dictionary - optimal marginal distribution of (T,Z)</span>

<span class="sd">              keys: t,z</span>
<span class="sd">              values: Q(t,z)</span>

<span class="sd">            dictionary - optimal marginal distribution of (X,Y)</span>

<span class="sd">              keys: x,y</span>
<span class="sd">              values: Q(x,y)</span>

<span class="sd">            dictionary - optimal marginal distribution of (X,Z)</span>

<span class="sd">              keys: x,z</span>
<span class="sd">              values: Q(x,z)</span>

<span class="sd">            dictionary - optimal marginal distribution of (Y,Z)</span>

<span class="sd">              keys: y,z</span>
<span class="sd">              values: Q(y,z)</span>

<span class="sd">            dictionary - optimal marginal distribution of (T,X,Y)</span>

<span class="sd">              keys: t,x,y</span>
<span class="sd">              values: Q(t,x,y)</span>

<span class="sd">            dictionary - optimal marginal distribution of (T,X,Z)</span>

<span class="sd">              keys: t,x,z</span>
<span class="sd">              values: Q(t,x,z)</span>

<span class="sd">            dictionary - optimal marginal distribution of (T,Y,Z)</span>

<span class="sd">              keys: t,y,z</span>
<span class="sd">              values: Q(t,y,z)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">TRIVARIATE_UNQ</span><span class="o">.</span><span class="n">marginals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">,</span><span class="n">sol_rpq</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span></div>

<div class="viewcode-block" id="Opt_II.create_model"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_II.create_model">[docs]</a>    <span class="k">def</span> <span class="nf">create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates the exponential Cone Program min_{q in Delta_d}H(T|U,V)</span>
<span class="sd">           of the form </span>
<span class="sd">              min. c&#39;x</span>
<span class="sd">              s.t.</span>

<span class="sd">                  Ax = b</span>
<span class="sd">                  Gx &lt;=_K h</span>

<span class="sd">             where </span>

<span class="sd">                   x = (r,p,q)</span>
<span class="sd">                   K represents a vector representing cones (K_1, K_2)</span>
<span class="sd">                   such that K_1 is a vector repesenting exponential cones </span>
<span class="sd">                   K_2 is a vector repesenting nonnegative cones </span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             which_sources: [1,2] if sources are X and Y </span>
<span class="sd">                            [1,3] if sources are X and Z</span>
<span class="sd">                            [2,3] if sources are Y and Z</span>

<span class="sd">        Returns: </span>
<span class="sd">            numpy.array - objective function weights</span>
<span class="sd">            scipy.sparse.csc_matrix - matrix of exponential and nonnegative </span>
<span class="sd">            inequalities</span>
<span class="sd">            numpy.array - L.H.S. of inequalities </span>
<span class="sd">            dictionary -  cones to be used </span>

<span class="sd">                keys: string - cone type (exponential or nonegative)</span>
<span class="sd">                values: int - number of cones</span>

<span class="sd">            scipy.sparse.csc_matrix - Matrix of marginal, q-w coupling, and </span>
<span class="sd">            q-p coupling equations </span>
<span class="sd">            numpy.array - L.H.S. of equalities </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">TRIVARIATE_UNQ</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Opt_II.solve"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_II.solve">[docs]</a>    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Solves the exponential Cone Program min_{Delta_p}H(T|U,V) where U,V in {X,Y,Z}</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            c: numpy.array - objective function weights</span>
<span class="sd">            G: scipy.sparse.csc_matrix - matrix of exponential and nonnegative </span>
<span class="sd">            inequalities</span>
<span class="sd">            h: numpy.array - L.H.S. of inequalities </span>
<span class="sd">            dims: dictionary -  cones to be used </span>

<span class="sd">                    keys: string - cone type (exponential or nonegative)</span>
<span class="sd">                    values: int - number of cones</span>

<span class="sd">            A: scipy.sparse.csc_matrix - Matrix of marginal, q-w coupling, and </span>
<span class="sd">            q-p coupling equations </span>
<span class="sd">            b: numpy.array - L.H.S. of equalities </span>
<span class="sd">            output: int - print different outputs based on (int) to console</span>
<span class="sd"> </span>
<span class="sd">       Returns: </span>
<span class="sd">            sol_rpq:    numpy.array - primal optimal solution</span>
<span class="sd">            sol_slack:  numpy.array - slack of primal optimal solution (G*sol_rpq - h)</span>
<span class="sd">            sol_lambda: numpy.array - equalities dual optimal solution</span>
<span class="sd">            sol_mu:     numpy.array - inequalities dual  optimal solution   </span>
<span class="sd">            sol_info:   dictionary - Brief stats of the optimization from ECOS</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">TRIVARIATE_UNQ</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Opt_II.dual_value"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_II.dual_value">[docs]</a>    <span class="k">def</span> <span class="nf">dual_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates the dual value of H(T|U,V) where U,V in {X,Y,Z}</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             sol_lambda: numpy.array - equalities dual optimal solution</span>
<span class="sd">             b: numpy.array - L.H.S. of equalities </span>
<span class="sd">        </span>
<span class="sd">        Returns: </span>
<span class="sd">            float </span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">TRIVARIATE_UNQ</span><span class="o">.</span><span class="n">dual_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="Opt_II.check_feasibility"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_II.check_feasibility">[docs]</a>    <span class="k">def</span> <span class="nf">check_feasibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">,</span> <span class="n">sol_rpq</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks the KKT conditions of the exponential Cone Program min_{Delta_p}H(T|U,V) </span>
<span class="sd">          where U,V in {X,Y,Z}</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             which_sources: [1,2] if sources are X and Y </span>
<span class="sd">                            [1,3] if sources are X and Z</span>
<span class="sd">                            [2,3] if sources are Y and Z</span>

<span class="sd">             sol_rpq:    numpy.array - primal optimal solution</span>
<span class="sd">             sol_slack:  numpy.array - slack of primal optimal solution (G*sol_rpq - h)</span>
<span class="sd">             sol_lambda: numpy.array - equalities dual optimal solution</span>
<span class="sd">             sol_mu:     numpy.array - inequalities dual  optimal solution   </span>
<span class="sd">             output: int - print different outputs based on (int) to console</span>

<span class="sd">        Returns: </span>
<span class="sd">             primal_infeasability: float - maximum violation of the optimal primal solution</span>
<span class="sd">             for primal equalities and inequalities</span>
<span class="sd">             dual_infeasability:   float - maximum violation of the optimal dual solution</span>
<span class="sd">             for dual equalities and inequalities</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">TRIVARIATE_UNQ</span><span class="o">.</span><span class="n">check_feasibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">,</span> <span class="n">sol_rpq</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Opt_II.condentropy_2vars"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.Opt_II.condentropy_2vars">[docs]</a>    <span class="k">def</span> <span class="nf">condentropy_2vars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">,</span><span class="n">sol_rpq</span><span class="p">,</span><span class="n">output</span><span class="p">,</span><span class="n">marg_XY</span><span class="p">,</span><span class="n">marg_XZ</span><span class="p">,</span><span class="n">marg_YZ</span><span class="p">,</span><span class="n">marg_TXY</span><span class="p">,</span><span class="n">marg_TXZ</span><span class="p">,</span><span class="n">marg_TYZ</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evalutes the value of H(T|U,V) w.r.t. the optimal distribution where U,V in {X,Y,Z}</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             which_sources: [1,2] if sources are X and Y </span>
<span class="sd">                            [1,3] if sources are X and Z</span>
<span class="sd">                            [2,3] if sources are Y and Z</span>

<span class="sd">             sol_rpq:    numpy.array - primal optimal solution</span>
<span class="sd">             output: int - print different outputs based on (int) to console</span>
<span class="sd">             marg_XY: dictionary - optimal marginal distribution of (X,Y)</span>

<span class="sd">                      keys: x,y</span>
<span class="sd">                      values: Q(x,y)</span>

<span class="sd">             marg_XZ: dictionary - optimal marginal distribution of (X,Z)</span>

<span class="sd">                      keys: x,z</span>
<span class="sd">                      values: Q(x,z)</span>

<span class="sd">             marg_YZ: dictionary - optimal marginal distribution of (Y,Z)</span>

<span class="sd">                      keys: y,z</span>
<span class="sd">                      values: Q(y,z)</span>

<span class="sd">             marg_TXY: dictionary - optimal marginal distribution of (T,X,Y)</span>

<span class="sd">                       keys: t,x,y</span>
<span class="sd">                       values: Q(t,x,y)</span>

<span class="sd">             marg_TXZ: dictionary - optimal marginal distribution of (T,X,Z)</span>

<span class="sd">                       keys: t,x,z</span>
<span class="sd">                       values: Q(t,x,z)</span>

<span class="sd">             marg_TYZ: dictionary - optimal marginal distribution of (T,Y,Z)</span>

<span class="sd">                       keys: t,y,z</span>
<span class="sd">                       values: Q(t,y,z)</span>

<span class="sd">        Returns: </span>
<span class="sd">            (if [1,2]: U,V=X,Y | if [1,3]: U,V=X,Z | if [2,3]: U,V=Y,Z)</span>
<span class="sd">            mysum: float - H(T|U,V)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">TRIVARIATE_UNQ</span><span class="o">.</span><span class="n">condentropy_2vars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_sources</span><span class="p">,</span><span class="n">sol_rpq</span><span class="p">,</span><span class="n">output</span><span class="p">,</span><span class="n">marg_XY</span><span class="p">,</span><span class="n">marg_XZ</span><span class="p">,</span><span class="n">marg_YZ</span><span class="p">,</span><span class="n">marg_TXY</span><span class="p">,</span><span class="n">marg_TXZ</span><span class="p">,</span><span class="n">marg_TYZ</span><span class="p">)</span></div></div>

<span class="c1">#^ subclass Opt_II</span>

<div class="viewcode-block" id="QP"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.QP">[docs]</a><span class="k">class</span> <span class="nc">QP</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Implements the functions that recover the solution </span>
<span class="sd">    (if needed) using Quadratic Programming</span>
<span class="sd">    (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">    Permission to use and modify under Apache License version 2.0</span>
<span class="sd">    </span>
<span class="sd">    Methods:</span>
<span class="sd">       create_model(which_sources,output)</span>
<span class="sd">          Creates the second-order cone program min_{Pi_x} (x - y)^2  </span>
<span class="sd">       solve(c,G,h,dims,A,b,output)</span>
<span class="sd">          Solves the second-order cone program min_{Pi_x} (x - y)^2  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CI</span><span class="p">,</span> <span class="n">SI</span><span class="p">,</span> <span class="n">UIX</span><span class="p">,</span> <span class="n">UIY</span><span class="p">,</span> <span class="n">UIZ</span><span class="p">,</span> <span class="n">UIXY</span><span class="p">,</span> <span class="n">UIXZ</span><span class="p">,</span> <span class="n">UIYZ</span><span class="p">,</span> <span class="n">MI</span><span class="p">,</span> <span class="n">MIX</span><span class="p">,</span> <span class="n">MIY</span><span class="p">,</span> <span class="n">MIZ</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">        Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">        Args: </span>
<span class="sd">            CI:(float,float) - returned synergy and </span>
<span class="sd">            confidence of the returned synergy</span>
<span class="sd">            SI:(float,float) - returned shared and</span>
<span class="sd">            confidence of the returned shared</span>
<span class="sd">            UIX:(float,float) - returned unique X and </span>
<span class="sd">            confidence of the returned unique X</span>
<span class="sd">            UIY:(float,float) - returned unique Y and </span>
<span class="sd">            confidence of the returned unique Y</span>
<span class="sd">            UIZ:(float,float) - returned unique Z and </span>
<span class="sd">            confidence of the returned unique Z</span>
<span class="sd">            UIXY:(float,float) - returned unique X Y and </span>
<span class="sd">            confidence of the returned unique X Y</span>
<span class="sd">            UIXZ:(float,float) - returned unique X Z and </span>
<span class="sd">            confidence of the returned unique X Z</span>
<span class="sd">            UIYZ:(float,float) - returned unique Y Z and </span>
<span class="sd">            confidence of the returned unique Y Z</span>
<span class="sd">            </span>
<span class="sd">            MI: float - MI(T;X,Y,Z)</span>
<span class="sd">            MIX:float - MI(T;X)</span>
<span class="sd">            MIY:float - MI(T;Y)</span>
<span class="sd">            MIZ:float - MI(T;Z)</span>

<span class="sd">        where the confidence is computed based on the duality gaps of </span>
<span class="sd">        the failed optimization problems </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># ECOS parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ecos_kwargs</span>   <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>       <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Probability density funciton data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CI_e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI_c</span>     <span class="o">=</span> <span class="n">CI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SI_e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SI_c</span>     <span class="o">=</span> <span class="n">SI</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">UIX_e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">UIX_c</span>   <span class="o">=</span> <span class="n">UIX</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UIY_e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">UIY_c</span>   <span class="o">=</span> <span class="n">UIY</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UIZ_e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">UIZ_c</span>   <span class="o">=</span> <span class="n">UIZ</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">UIXY_e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">UIXY_c</span> <span class="o">=</span> <span class="n">UIXY</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UIXZ_e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">UIXZ_c</span> <span class="o">=</span> <span class="n">UIXZ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UIYZ_e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">UIYZ_c</span> <span class="o">=</span> <span class="n">UIYZ</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">MI</span>  <span class="o">=</span> <span class="n">MI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MIX</span> <span class="o">=</span> <span class="n">MIX</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MIY</span> <span class="o">=</span> <span class="n">MIY</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MIZ</span> <span class="o">=</span> <span class="n">MIZ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="c1">#^ init()</span>

<div class="viewcode-block" id="QP.create_model"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.QP.create_model">[docs]</a>    <span class="k">def</span> <span class="nf">create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_probs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates the second-order cone program min_{Pi_x}1/2 x^TWx + f^T x</span>
<span class="sd">           of the form </span>
<span class="sd">                      min 1/2 x^TWx + f^T x</span>
<span class="sd">                      subject to</span>

<span class="sd">                            Ax  = b</span>
<span class="sd">                            x &gt;= 0</span>

<span class="sd">           The model can be written as SOCP:</span>
<span class="sd">           min 1/2 t + f^T x</span>
<span class="sd">           subject to</span>

<span class="sd">                 Ax = b</span>
<span class="sd">                [W^(1/2), t, 1] in SOC</span>
<span class="sd">                 x &gt;= 0</span>

<span class="sd">           In ECOS </span>

<span class="sd">               min c^T[t,x]</span>
<span class="sd">               subject to</span>

<span class="sd">                     Ax = b</span>
<span class="sd">                     [-I, W^(1/2)]*[t,x]^T &lt;_{K} [0, 0, 0]</span>

<span class="sd">           where K := R_+ . Q, c^T := [1/2,f^T]</span>

<span class="sd">        Args:</span>
<span class="sd">             which_probs: list(int) - [1]  if min_{Delta_p}H(T|X,Y,Z) failed</span>
<span class="sd">                                      [12] if min_{Delta_p}H(T|X,Y) failed</span>
<span class="sd">                                      [12] if min_{Delta_p}H(T|X,Z) failed</span>
<span class="sd">                                      [12] if min_{Delta_p}H(T|Y,Z) failed</span>
<span class="sd">                                      [1,12]  if min_{Delta_p}H(T|X,Y,Z) and </span>

<span class="sd">                                                 min_{Delta_p}H(T|X,Y) failed</span>

<span class="sd">                                      [1,13]  if min_{Delta_p}H(T|X,Y,Z) and </span>
<span class="sd">                                                 min_{Delta_p}H(T|X,Z) failed</span>
<span class="sd">                                      [1,23]  if min_{Delta_p}H(T|X,Y,Z) and </span>
<span class="sd">                                                 min_{Delta_p}H(T|Y,Z) failed</span>
<span class="sd">                                      [12,13] if min_{Delta_p}H(T|X,Y) and </span>
<span class="sd">                                                 min_{Delta_p}H(T|X,Z) failed</span>
<span class="sd">                                      [12,23] if min_{Delta_p}H(T|X,Y) and </span>
<span class="sd">                                                 min_{Delta_p}H(T|Y,Z) failed</span>
<span class="sd">                                      [13,23] if min_{Delta_p}H(T|X,Z) and </span>
<span class="sd">                                                 min_{Delta_p}H(T|Y,Z) failed</span>
<span class="sd">                                      [1,12,13]  if min_{Delta_p}H(T|X,Y,Z),</span>
<span class="sd">                                                    min_{Delta_p}H(T|X,Y), and </span>
<span class="sd">                                                    min_{Delta_p}H(T|X,Z) failed</span>
<span class="sd">                                      [1,12,23]  if min_{Delta_p}H(T|X,Y,Z),</span>
<span class="sd">                                                    min_{Delta_p}H(T|X,Y), and </span>
<span class="sd">                                                    min_{Delta_p}H(T|Y,Z) failed</span>
<span class="sd">                                      [1,13,23]  if min_{Delta_p}H(T|X,Y,Z),</span>
<span class="sd">                                                    min_{Delta_p}H(T|X,Z), and </span>
<span class="sd">                                                    min_{Delta_p}H(T|Y,Z) failed</span>
<span class="sd">                                      [12,13,23] if min_{Delta_p}H(T|X,Y),</span>
<span class="sd">                                                    min_{Delta_p}H(T|X,Z), and </span>
<span class="sd">                                                    min_{Delta_p}H(T|Y,Z) failed</span>

<span class="sd">        Returns: </span>
<span class="sd">            numpy.array - objective function weights</span>
<span class="sd">            scipy.sparse.csc_matrix - matrix of soc and nonnegative </span>
<span class="sd">            inequalities</span>
<span class="sd">            numpy.array - L.H.S. of inequalities </span>
<span class="sd">            dictionary -  cones to be used </span>

<span class="sd">                keys: string - cone type (soc or nonegative)</span>
<span class="sd">                values: int - number of cones</span>

<span class="sd">            scipy.sparse.csc_matrix - Matrix of identity equations </span>
<span class="sd">            numpy.array - L.H.S. of equalities </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="n">TRIVARIATE_QP</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_probs</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="QP.solve"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.QP.solve">[docs]</a>    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Solves the second-order cone program min_{Pi_x}1/2 x^TWx + f^T x</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            c: numpy.array - objective function weights</span>
<span class="sd">            G: scipy.sparse.csc_matrix - matrix of soc and nonnegative </span>
<span class="sd">            inequalities</span>
<span class="sd">            h: numpy.array - L.H.S. of inequalities </span>
<span class="sd">            dims: dictionary -  cones to be used </span>

<span class="sd">                    keys: string - cone type (soc or nonegative)</span>
<span class="sd">                    values: int - number of cones</span>

<span class="sd">            A: scipy.sparse.csc_matrix - Matrix of identity equations </span>
<span class="sd">            b: numpy.array - L.H.S. of equalities </span>
<span class="sd">            output: int - print different outputs based on (int) to console</span>
<span class="sd"> </span>
<span class="sd">       Returns: </span>
<span class="sd">            sol_tx:     numpy.array - primal optimal solution</span>
<span class="sd">            sol_slack:  numpy.array - slack of primal optimal solution (G*sol_rpq - h)</span>
<span class="sd">            sol_lambda: numpy.array - equalities dual optimal solution</span>
<span class="sd">            sol_mu:     numpy.array - inequalities dual  optimal solution   </span>
<span class="sd">            sol_info:   dictionary - Brief stats of the optimization from ECOS</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="n">TRIVARIATE_QP</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span></div></div>

<span class="c1">#^ class QP</span>

<span class="c1"># Compute Marginals</span>

<div class="viewcode-block" id="marginal_tx"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.marginal_tx">[docs]</a><span class="k">def</span> <span class="nf">marginal_tx</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the original marginal distribution of T and X </span>
<span class="sd">       (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">       Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">       Args: </span>
<span class="sd">            p: dict </span>
<span class="sd">                 keys: (t,x,y,z)</span>
<span class="sd">                 values: P(t,x,y,z)</span>

<span class="sd">       Returns: </span>
<span class="sd">            dict - original marginal distribution of T and X</span>
<span class="sd">              keys: (t,x)</span>
<span class="sd">              values: P(t,x)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">marg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">marg</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>    <span class="n">marg</span><span class="p">[(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span>                       <span class="n">marg</span><span class="p">[(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)]</span> <span class="o">=</span>  <span class="n">r</span>
    <span class="k">return</span> <span class="n">marg</span></div>
<span class="c1">#^ marginal_tx()</span>

<div class="viewcode-block" id="marginal_ty"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.marginal_ty">[docs]</a><span class="k">def</span> <span class="nf">marginal_ty</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the original marginal distribution of T and Y </span>
<span class="sd">       (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">       Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">       Args: </span>
<span class="sd">            p: dict </span>
<span class="sd">                 keys: (t,x,y,z)</span>
<span class="sd">                 values: P(t,x,y,z)</span>

<span class="sd">       Returns: </span>
<span class="sd">            dict - original marginal distribution of T and Y</span>
<span class="sd">              keys: (t,y)</span>
<span class="sd">              values: P(t,y)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">marg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">marg</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>   <span class="n">marg</span><span class="p">[(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span>                      <span class="n">marg</span><span class="p">[(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)]</span> <span class="o">=</span>  <span class="n">r</span>
    <span class="k">return</span> <span class="n">marg</span></div>
<span class="c1">#^ marginal_ty()</span>

<div class="viewcode-block" id="marginal_tz"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.marginal_tz">[docs]</a><span class="k">def</span> <span class="nf">marginal_tz</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the original marginal distribution of T and Z</span>
<span class="sd">       (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">       Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">       Args: </span>
<span class="sd">            p: dict </span>
<span class="sd">                 keys: (t,x,y,z)</span>
<span class="sd">                 values: P(t,x,y,z)</span>

<span class="sd">       Returns: </span>
<span class="sd">            dict - original marginal distribution of T and Z</span>
<span class="sd">              keys: (t,z)</span>
<span class="sd">              values: P(t,z)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">marg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="n">marg</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>   <span class="n">marg</span><span class="p">[(</span><span class="n">t</span><span class="p">,</span><span class="n">z</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span>                      <span class="n">marg</span><span class="p">[(</span><span class="n">t</span><span class="p">,</span><span class="n">z</span><span class="p">)]</span> <span class="o">=</span>  <span class="n">r</span>
    <span class="k">return</span> <span class="n">marg</span></div>
<span class="c1">#^ marginal_tz()</span>

<div class="viewcode-block" id="marginal_xy"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.marginal_xy">[docs]</a><span class="k">def</span> <span class="nf">marginal_xy</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the original marginal distribution of X and Y </span>
<span class="sd">       (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">       Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">       Args: </span>
<span class="sd">            p: dict </span>
<span class="sd">                 keys: (t,x,y,z)</span>
<span class="sd">                 values: P(t,x,y,z)</span>

<span class="sd">       Returns: </span>
<span class="sd">            dict - original marginal distribution of X and Y</span>
<span class="sd">              keys: (x,y)</span>
<span class="sd">              values: P(x,y)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">marg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">marg</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>   <span class="n">marg</span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span>                      <span class="n">marg</span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)]</span> <span class="o">=</span>  <span class="n">r</span>
    <span class="k">return</span> <span class="n">marg</span></div>
<span class="c1">#^ marginal_xy()</span>

<div class="viewcode-block" id="marginal_xz"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.marginal_xz">[docs]</a><span class="k">def</span> <span class="nf">marginal_xz</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the original marginal distribution of X and Z </span>
<span class="sd">       (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">       Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">       Args: </span>
<span class="sd">            p: dict </span>
<span class="sd">                 keys: (t,x,y,z)</span>
<span class="sd">                 values: P(t,x,y,z)</span>

<span class="sd">       Returns: </span>
<span class="sd">            dict - original marginal distribution of X and Z</span>
<span class="sd">              keys: (x,z)</span>
<span class="sd">              values: P(x,z)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">marg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="n">marg</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>   <span class="n">marg</span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span>                      <span class="n">marg</span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">)]</span> <span class="o">=</span>  <span class="n">r</span>
    <span class="k">return</span> <span class="n">marg</span></div>
<span class="c1">#^ marginal_xz()</span>

<div class="viewcode-block" id="marginal_yz"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.marginal_yz">[docs]</a><span class="k">def</span> <span class="nf">marginal_yz</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the original marginal distribution of Y and Z </span>
<span class="sd">       (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">       Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">       Args: </span>
<span class="sd">            p: dict </span>
<span class="sd">                 keys: (t,x,y,z)</span>
<span class="sd">                 values: P(t,x,y,z)</span>

<span class="sd">       Returns: </span>
<span class="sd">            dict - original marginal distribution of Y and Z</span>
<span class="sd">              keys: (y,z)</span>
<span class="sd">              values: P(y,z)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">marg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="n">marg</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>   <span class="n">marg</span><span class="p">[(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span>                      <span class="n">marg</span><span class="p">[(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)]</span> <span class="o">=</span>  <span class="n">r</span>
    <span class="k">return</span> <span class="n">marg</span></div>
<span class="c1">#^ marginal_yz()</span>


<span class="c1"># Compute Conditional Entopy of the form H(T|V)</span>
<div class="viewcode-block" id="condent_V"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.condent_V">[docs]</a><span class="k">def</span> <span class="nf">condent_V</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes H(T|X), H(T|Y), or H(T|Z) w.r.t. the original distribution P </span>
<span class="sd">       of (T,X,Y,Z)</span>
<span class="sd">       (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">       Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             V: int -  if 1 computes  H(T|X) </span>
<span class="sd">                       if 2 computes  H(T|Y) </span>
<span class="sd">                       if 3 computes  H(T|Z) </span>
<span class="sd">             pdf: dict - the input distribution of (T,X,Y,Z)</span>
<span class="sd">                    Keys: (t,x,y,z)</span>
<span class="sd">                    values: P(t,x,y,z)</span>
<span class="sd">             output: int - print different outputs based on (int) to console</span>
<span class="sd">                     (default = 0)</span>

<span class="sd">        Returns: </span>
<span class="sd">            (if 1: V=X | if 2: V=Y | if 3: V=Z)</span>
<span class="sd">            mysum: float - H(T|V)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    

    <span class="c1"># Initialization</span>
    <span class="n">marg_V</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">mysum</span> <span class="o">=</span> <span class="mf">0.</span>
    
    <span class="c1"># Compute H(T|X)</span>
    <span class="k">if</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">itic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="n">b_tx</span> <span class="o">=</span> <span class="n">marginal_tx</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="c1"># Get P(*,x,*,*)</span>
        <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="c1">#^ for txyz exists</span>

        <span class="c1"># Subtract P(t,x,*,*) * ( P(t,x,*,*) / P(*,x,*,*) )  </span>
        <span class="k">for</span> <span class="n">tx</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">b_tx</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">tx</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">mysum</span> <span class="o">-=</span> <span class="n">r</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="c1">#^ for tx exists</span>
        <span class="n">itoc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.condent_V(): Time to compute H(T|X):&quot;</span><span class="p">,</span> <span class="n">itoc</span> <span class="o">-</span> <span class="n">itic</span><span class="p">,</span> <span class="s2">&quot;secs&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mysum</span>
    <span class="c1">#^ if</span>

    <span class="c1"># Compute H(T|Y)</span>
    <span class="k">if</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">itic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="n">b_ty</span> <span class="o">=</span> <span class="n">marginal_ty</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="c1"># Get P(*,*,y,*)</span>
        <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="c1">#^ for txyz exists</span>
        
        <span class="c1"># Subtract P(s,*,y,*) * ( P(s,*,y,*) / P(*,*,y,*) )  </span>
        <span class="k">for</span> <span class="n">ty</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">b_ty</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">ty</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">mysum</span> <span class="o">-=</span> <span class="n">r</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">r</span> <span class="o">/</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="p">)</span>
        <span class="c1">#^ for ty exists</span>
        <span class="n">itoc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">==</span><span class="mi">2</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.condent_V(): Time to compute H(T|Y):&quot;</span><span class="p">,</span> <span class="n">itoc</span> <span class="o">-</span> <span class="n">itic</span><span class="p">,</span> <span class="s2">&quot;secs&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mysum</span>
    <span class="c1">#^ if</span>

    <span class="c1"># Compute H(T|Z)</span>
    <span class="k">if</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">itic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="n">b_tz</span> <span class="o">=</span> <span class="n">marginal_tz</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="c1"># Get P(*,*,*,z)</span>
        <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="c1">#^ for txyz exists</span>

        <span class="c1"># Subtract P(t,*,*,z) * ( P(t,*,*,z) / P(*,*,*,z) )  </span>
        <span class="k">for</span> <span class="n">tz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">b_tz</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">tz</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">mysum</span> <span class="o">-=</span> <span class="n">r</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">r</span> <span class="o">/</span> <span class="n">marg_V</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="p">)</span>
        <span class="c1">#^ for tz exists</span>
        <span class="n">itoc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.condent_V(): Time to compute H(T|Z):&quot;</span><span class="p">,</span> <span class="n">itoc</span> <span class="o">-</span> <span class="n">itic</span><span class="p">,</span> <span class="s2">&quot;secs&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mysum</span></div>
    <span class="c1">#^ if</span>
<span class="c1">#^ condent_V()</span>

<span class="c1"># Compute the Mutual Information MI(T,V)</span>
<div class="viewcode-block" id="I_V"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.I_V">[docs]</a><span class="k">def</span> <span class="nf">I_V</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes MI(T;X), MI(T;Y), or MI(T;Z) w.r.t. the original distribution P </span>
<span class="sd">       of (T,X,Y,Z)</span>
<span class="sd">       (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">       Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             V: int -  if 1 computes  MI(T;X) </span>
<span class="sd">                       if 2 computes  MI(T;Y) </span>
<span class="sd">                       if 3 computes  MI(T;Z) </span>
<span class="sd">             p: dict - the input distribution of (T,X,Y,Z)</span>
<span class="sd">                    Keys: (t,x,y,z)</span>
<span class="sd">                    values: P(t,x,y,z)</span>

<span class="sd">        Returns: </span>
<span class="sd">            (if 1: V=X | if 2: V=Y | if 3: V=Z)</span>
<span class="sd">            mysum: float - MI(T;V)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Initialization</span>
    <span class="n">marg_V</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">marg_T</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">mysum</span> <span class="o">=</span> <span class="mf">0.</span>

    <span class="c1"># Compute I(T; X)</span>
    <span class="k">if</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">b_tx</span> <span class="o">=</span> <span class="n">marginal_tx</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
            <span class="c1"># Get P(t,*,*,*) &amp; P(*,x,*,*)</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>                
                <span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="c1">#^ for txyz exists</span>

        <span class="c1"># add P(t,x,*,*)*( P(t,x,*,*) / (P(t,*,*,*) * P(*,x,*,*) )</span>
        <span class="k">for</span> <span class="n">tx</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">b_tx</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">tx</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">mysum</span> <span class="o">+=</span> <span class="n">r</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span> <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
        <span class="c1">#^ for tx exists</span>
    <span class="c1">#^ if</span>

    <span class="c1"># Compute I(T; Y)</span>
    <span class="k">if</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">b_ty</span> <span class="o">=</span> <span class="n">marginal_ty</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
            <span class="c1"># Get P(t,*,*,*) &amp; P(*,*,y,*)</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>                
                <span class="n">marg_V</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="c1">#^ for txyz exists</span>

        <span class="c1"># add P(t,*,y,*)*( P(t,*,y,*) / (P(t,*,*,*) * P(*,*,y,*) )</span>
        <span class="k">for</span> <span class="n">ty</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">b_ty</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">ty</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">mysum</span> <span class="o">+=</span> <span class="n">r</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span> <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">marg_V</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
        <span class="c1">#^ for ty exists</span>
    <span class="c1">#^ if</span>
    
    <span class="c1"># Compute I(T; Z)</span>
    <span class="k">if</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">b_tz</span> <span class="o">=</span> <span class="n">marginal_tz</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="c1"># Get P(t,*,*,*) &amp; P(*,*,*,z)</span>
        <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>                
                <span class="n">marg_V</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="c1">#^ for txyz exists</span>

        <span class="c1"># add P(t,*,*,z)*( P(t,*,*,z) / (P(t,*,*,*) * P(*,*,*,z) ) </span>
        <span class="k">for</span> <span class="n">tz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">b_tz</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">tz</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">mysum</span> <span class="o">+=</span> <span class="n">r</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span><span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">marg_V</span><span class="p">[</span><span class="n">z</span><span class="p">])</span> <span class="p">)</span>
        <span class="c1">#^ for tz exists</span>
    <span class="c1">#^ if</span>

    <span class="k">return</span> <span class="n">mysum</span></div>
<span class="c1">#^ I_V()</span>



<div class="viewcode-block" id="I_VW"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.I_VW">[docs]</a><span class="k">def</span> <span class="nf">I_VW</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes MI(T;X,Y), MI(T;X,Z), or MI(T;Y,Z) w.r.t. the original distribution P </span>
<span class="sd">       of (T,X,Y,Z)</span>
<span class="sd">       (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">       Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             V: int -  if 12 computes  MI(T;X,Y) </span>
<span class="sd">                       if 13 computes  MI(T;X,Z) </span>
<span class="sd">                       if 23 computes  MI(T;Y,Z) </span>
<span class="sd">             pdf: dict - the input distribution of (T,X,Y,Z)</span>
<span class="sd">                    Keys: (t,x,y,z)</span>
<span class="sd">                    values: P(t,x,y,z)</span>
<span class="sd">             output: int - print different outputs based on (int) to console</span>
<span class="sd">                     (default = 0)</span>

<span class="sd">        Returns: </span>
<span class="sd">            (if 12: V,W=X,Y | if 13: V,W=X,Z | if 23: V,W=Y,Z)</span>
<span class="sd">            mysum: float - MI(T;V,W)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Initialization</span>
    <span class="n">marg_V</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">marg_VV</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">marg_T</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">mysum</span> <span class="o">=</span> <span class="mf">0.</span>

    <span class="c1"># Compute I(T; XY)</span>
    <span class="k">if</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
            <span class="c1"># Get P(t,*,*,*), P(*,x,y,*), P(t,x,y,*)</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>                
                <span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
                <span class="n">marg_VV</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="c1">#^ for txyz exists</span>

        <span class="c1"># add P(t,x,y,*)*log( P(t,x,y,*) / (P(t,*,*,*) * P(*,x,y,*) )</span>
        <span class="k">for</span> <span class="n">txy</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">marg_VV</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">txy</span>
            <span class="n">mysum</span> <span class="o">+=</span> <span class="n">r</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span> <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
        <span class="c1">#^ for tx exists</span>
    <span class="c1">#^ if</span>

    <span class="c1"># Compute I(T; XZ)</span>
    <span class="k">elif</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
            <span class="c1"># Get P(t,*,*,*), P(*,x,*,z) &amp; P(t,x,*,z)</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>                
                <span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
                <span class="n">marg_VV</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="c1">#^ for txyz exists</span>

        <span class="c1"># add P(t,x,*,z)*log( P(t,x,*,z) / (P(t,*,*,*) * P(*,x,*,z) )</span>
        <span class="k">for</span> <span class="n">txz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">marg_VV</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txz</span>
            <span class="n">mysum</span> <span class="o">+=</span> <span class="n">r</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span> <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
        <span class="c1">#^ for ty exists</span>
    <span class="c1">#^ if</span>
    
    <span class="c1"># Compute I(T; YZ)</span>
    <span class="k">elif</span> <span class="n">V</span> <span class="o">==</span> <span class="mi">23</span><span class="p">:</span>
        <span class="c1"># Get P(t,*,*,*), P(*,*,y,z) &amp; P(t,*,y,z)</span>
        <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>                
                <span class="n">marg_V</span><span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
                <span class="n">marg_VV</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
                
        <span class="c1">#^ for txyz exists</span>

        <span class="c1"># add P(t,*,y,z)*log( P(t,*,y,z) / (P(t,*,*,*) * P(*,*,y,z) ) </span>
        <span class="k">for</span> <span class="n">tyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">marg_VV</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">tyz</span>
            <span class="n">mysum</span> <span class="o">+=</span> <span class="n">r</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span><span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">marg_V</span><span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span> <span class="p">)</span>
        <span class="c1">#^ for tz exists</span>
    <span class="c1">#^ if</span>

    <span class="k">return</span> <span class="n">mysum</span></div>
<span class="c1">#^ I_VW()</span>


<div class="viewcode-block" id="I_XYZ"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.I_XYZ">[docs]</a><span class="k">def</span> <span class="nf">I_XYZ</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes MI(T;X,Y,Z) w.r.t. the original distribution P </span>
<span class="sd">       of (T,X,Y,Z)</span>
<span class="sd">       (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">       Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             pdf: dict - the input distribution of (T,X,Y,Z)</span>
<span class="sd">                    Keys: (t,x,y,z)</span>
<span class="sd">                    values: P(t,x,y,z)</span>
<span class="sd">        Returns: </span>
<span class="sd">            mysum: float - MI(T;X,Y,Z)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialization</span>
    <span class="n">marg_V</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">marg_T</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">mysum</span> <span class="o">=</span> <span class="mf">0.</span>

    <span class="c1"># Compute I(T; XYZ)</span>
    <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
        <span class="c1"># Get P(t,*,*,*), P(*,x,y,z)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>                
            <span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span>
        <span class="c1">#^ if </span>
    <span class="c1">#^ for txyz exists</span>

    <span class="c1"># add P(t,x,y,z)*log( P(t,x,y,z) / (P(t,*,*,*) * P(*,x,y,z) )</span>
    <span class="k">for</span> <span class="n">txyz</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">txyz</span>
        <span class="n">mysum</span> <span class="o">+=</span> <span class="n">r</span><span class="o">*</span><span class="n">log</span><span class="p">(</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span> <span class="n">marg_T</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">marg_V</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
    <span class="c1">#^ for tx exists</span>
    <span class="k">return</span> <span class="n">mysum</span></div>
<span class="c1">#^ I_XYZ()</span>


<div class="viewcode-block" id="pid"><a class="viewcode-back" href="../MAXENT3D_PID.html#MAXENT3D_PID.pid">[docs]</a><span class="k">def</span> <span class="nf">pid</span><span class="p">(</span><span class="n">pdf_dirty</span><span class="p">,</span> <span class="n">cone_solver</span><span class="o">=</span><span class="s1">&#39;ECOS&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solver_args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the partial information decomposition of  (T,X,Y,Z)</span>
<span class="sd">       (c) Abdullah Makkeh, Dirk Oliver Theis</span>
<span class="sd">       Permission to use and modify under Apache License version 2.0</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">             pdf_dirty: dict - the original distribution of (T,X,Y,Z)</span>
<span class="sd">                    Keys: (t,x,y,z)</span>
<span class="sd">                    values: P(t,x,y,z)</span>
<span class="sd">                    (dirty refers to the values = 0)</span>
<span class="sd">             </span>
<span class="sd">             cone_solver: string - name of the cone solver </span>
<span class="sd">                          (Default = &#39;ECOS&#39;)</span>
<span class="sd">                          (Currently only ECOS) </span>

<span class="sd">             output: int - print different outputs based on (int) to console (default = 0)</span>
<span class="sd">             </span>
<span class="sd">             parallel: string - determines whether computation will be done in parallel</span>

<span class="sd">                                if &#39;off&#39; sequential computation </span>

<span class="sd">                                if &#39;on&#39;  parallel computations </span>

<span class="sd">                                (default = &#39;off&#39;)</span>

<span class="sd">             **solver_args: pointer to dict() - dictionary of ECOS parameters (default = None)</span>

<span class="sd">        Returns: </span>
<span class="sd">                return_data: dict() - estimated decomposition, solver used, numerical error</span>
<span class="sd">                         </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">pdf_dirty</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">,</span> <span class="s2">&quot;MAXENT3D_PID.pid(pdf): pdf must be a dictionary&quot;</span>
    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">cone_solver</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;MAXENT3D_PID.pid(pdf): `cone_solver&#39; parameter must be string (e.g., &#39;ECOS&#39;)&quot;</span>
    <span class="k">if</span> <span class="n">__debug__</span><span class="p">:</span>
        <span class="n">sum_p</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">pdf_dirty</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">,</span>           <span class="s2">&quot;MAXENT3D_PID.pid(pdf): pdf&#39;s keys must be tuples or lists&quot;</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">,</span>                                     <span class="s2">&quot;MAXENT3D_PID.pid(pdf): pdf&#39;s keys must be tuples/lists of length 4&quot;</span>
            <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">float</span> <span class="ow">or</span> <span class="p">(</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">==</span><span class="nb">int</span> <span class="ow">and</span> <span class="n">v</span><span class="o">==</span><span class="mi">0</span> <span class="p">),</span> <span class="s2">&quot;MAXENT3D_PID.pid(pdf): pdf&#39;s values must be floats&quot;</span>
            <span class="k">assert</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="o">-.</span><span class="mi">1</span><span class="p">,</span>                                       <span class="s2">&quot;MAXENT3D_PID.pid(pdf): pdf&#39;s values must not be negative&quot;</span>
            <span class="n">sum_p</span> <span class="o">+=</span> <span class="n">v</span>
        <span class="c1">#^ for</span>
        <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sum_p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span> <span class="mf">1.e-10</span><span class="p">,</span>                                       <span class="s2">&quot;MAXENT3D_PID.pid(pdf): pdf&#39;s values must sum up to 1 (tolerance of precision is 1.e-10)&quot;</span>
    <span class="c1">#^ if</span>
    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">,</span> <span class="s2">&quot;MAXENT3D_PID.pid(pdf,output): output must be an integer&quot;</span>

    <span class="c1"># Check if the solver is implemented:</span>
    <span class="k">assert</span> <span class="n">cone_solver</span><span class="o">==</span><span class="s2">&quot;ECOS&quot;</span><span class="p">,</span> <span class="s2">&quot;MAXENT3D_PID.pid(pdf): We currently don&#39;t have an interface for the Cone Solver &quot;</span><span class="o">+</span><span class="n">cone_solver</span><span class="o">+</span><span class="s2">&quot; (only ECOS).&quot;</span>

    <span class="n">pdf</span> <span class="o">=</span> <span class="p">{</span> <span class="n">k</span><span class="p">:</span><span class="n">v</span>  <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">pdf_dirty</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mf">1.e-300</span> <span class="p">}</span>

    <span class="n">tic_marg</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">bx_tx</span> <span class="o">=</span> <span class="n">marginal_tx</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
    <span class="n">by_ty</span> <span class="o">=</span> <span class="n">marginal_ty</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
    <span class="n">bz_tz</span> <span class="o">=</span> <span class="n">marginal_tz</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>

    <span class="n">b_xy</span> <span class="o">=</span> <span class="n">marginal_xy</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
    <span class="n">b_xz</span> <span class="o">=</span> <span class="n">marginal_xz</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
    <span class="n">b_yz</span> <span class="o">=</span> <span class="n">marginal_yz</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
    
    <span class="n">toc_marg</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Time to create marginals:&quot;</span><span class="p">,</span> <span class="n">toc_marg</span> <span class="o">-</span> <span class="n">tic_marg</span><span class="p">,</span> <span class="s2">&quot;secs</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># if cone_solver==&quot;ECOS&quot;: .....</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Preparing Cone Program data&quot;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">solver</span> <span class="o">=</span> <span class="n">Solve_w_ECOS</span><span class="p">(</span><span class="n">bx_tx</span><span class="p">,</span> <span class="n">by_ty</span><span class="p">,</span> <span class="n">bz_tz</span><span class="p">,</span> <span class="n">b_xy</span><span class="p">,</span> <span class="n">b_xz</span><span class="p">,</span> <span class="n">b_yz</span><span class="p">)</span>
    <span class="n">subsolver_I</span> <span class="o">=</span> <span class="n">Opt_I</span><span class="p">(</span><span class="n">bx_tx</span><span class="p">,</span> <span class="n">by_ty</span><span class="p">,</span> <span class="n">bz_tz</span><span class="p">,</span> <span class="n">b_xy</span><span class="p">,</span> <span class="n">b_xz</span><span class="p">,</span> <span class="n">b_yz</span><span class="p">)</span>
    <span class="n">subsolver_II</span> <span class="o">=</span> <span class="n">Opt_II</span><span class="p">(</span><span class="n">bx_tx</span><span class="p">,</span> <span class="n">by_ty</span><span class="p">,</span> <span class="n">bz_tz</span><span class="p">,</span> <span class="n">b_xy</span><span class="p">,</span> <span class="n">b_xz</span><span class="p">,</span> <span class="n">b_yz</span><span class="p">)</span>

    <span class="n">tic_mod</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">parallel</span> <span class="o">==</span> <span class="s1">&#39;on&#39;</span><span class="p">:</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">()</span>
        <span class="c1"># call create_model() for min -H( T|XY ), min -H( T|XZ ), min -H( T|YZ )</span>
        <span class="n">cre_12</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">create_model</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">output</span> <span class="p">])</span>
        <span class="n">cre_13</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">create_model</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">output</span> <span class="p">])</span>
        <span class="n">cre_23</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">create_model</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">output</span> <span class="p">])</span>

        <span class="c1"># call create_model() for min -H( T|XYZ )</span>
        <span class="n">cre_I</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_I</span><span class="o">.</span><span class="n">create_model</span><span class="p">,</span> <span class="p">[</span> <span class="n">output</span> <span class="p">])</span>

        <span class="c1"># Get the models</span>
        <span class="n">c_I</span><span class="p">,</span> <span class="n">G_I</span><span class="p">,</span> <span class="n">h_I</span><span class="p">,</span> <span class="n">dims_I</span><span class="p">,</span> <span class="n">A_I</span><span class="p">,</span> <span class="n">b_I</span> <span class="o">=</span> <span class="n">cre_I</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">c_12</span><span class="p">,</span> <span class="n">G_12</span><span class="p">,</span> <span class="n">h_12</span><span class="p">,</span> <span class="n">dims_12</span><span class="p">,</span> <span class="n">A_12</span><span class="p">,</span> <span class="n">b_12</span> <span class="o">=</span> <span class="n">cre_12</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">c_13</span><span class="p">,</span> <span class="n">G_13</span><span class="p">,</span> <span class="n">h_13</span><span class="p">,</span> <span class="n">dims_13</span><span class="p">,</span> <span class="n">A_13</span><span class="p">,</span> <span class="n">b_13</span> <span class="o">=</span> <span class="n">cre_13</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">c_23</span><span class="p">,</span> <span class="n">G_23</span><span class="p">,</span> <span class="n">h_23</span><span class="p">,</span> <span class="n">dims_23</span><span class="p">,</span> <span class="n">A_23</span><span class="p">,</span> <span class="n">b_23</span> <span class="o">=</span> <span class="n">cre_23</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># create model min -H( T|XYZ )</span>
        <span class="n">c_I</span><span class="p">,</span> <span class="n">G_I</span><span class="p">,</span> <span class="n">h_I</span><span class="p">,</span> <span class="n">dims_I</span><span class="p">,</span> <span class="n">A_I</span><span class="p">,</span> <span class="n">b_I</span> <span class="o">=</span> <span class="n">subsolver_I</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

        <span class="c1"># create models min -H( T|XY ), min -H( T|XZ ), min -H( T|YZ )</span>
        <span class="n">c_12</span><span class="p">,</span> <span class="n">G_12</span><span class="p">,</span> <span class="n">h_12</span><span class="p">,</span> <span class="n">dims_12</span><span class="p">,</span> <span class="n">A_12</span><span class="p">,</span> <span class="n">b_12</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">create_model</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">c_13</span><span class="p">,</span> <span class="n">G_13</span><span class="p">,</span> <span class="n">h_13</span><span class="p">,</span> <span class="n">dims_13</span><span class="p">,</span> <span class="n">A_13</span><span class="p">,</span> <span class="n">b_13</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">create_model</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">c_23</span><span class="p">,</span> <span class="n">G_23</span><span class="p">,</span> <span class="n">h_23</span><span class="p">,</span> <span class="n">dims_23</span><span class="p">,</span> <span class="n">A_23</span><span class="p">,</span> <span class="n">b_23</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">create_model</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
    <span class="c1">#^ if parallel</span>
    
    <span class="n">toc_mod</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Time to create all models. &quot;</span><span class="p">,</span> <span class="n">toc_mod</span> <span class="o">-</span> <span class="n">tic_mod</span><span class="p">,</span> <span class="s2">&quot;secs</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">subsolver_I</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">subsolver_II</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        

    <span class="n">ecos_keep_solver_obj</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s1">&#39;keep_solver_object&#39;</span> <span class="ow">in</span> <span class="n">solver_args</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">solver_args</span><span class="p">[</span><span class="s1">&#39;keep_solver_object&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span> <span class="n">ecos_keep_solver_obj</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">del</span> <span class="n">solver_args</span><span class="p">[</span><span class="s1">&#39;keep_solver_object&#39;</span><span class="p">]</span>

    <span class="n">subsolver_I</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">solver_args</span>
    <span class="n">subsolver_II</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">solver_args</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Preparing Cone Program data is done.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Starting solver&quot;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Starting solver.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">parallel</span> <span class="o">==</span> <span class="s2">&quot;on&quot;</span><span class="p">:</span>

        <span class="c1"># Find the optimal solution of: min H(T|XYZ), min H(T|XY), H(T|XZ) and H(T|YZ)</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">()</span>
        <span class="c1"># Call solve()  </span>
        <span class="n">res_I</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_I</span><span class="o">.</span><span class="n">solve</span><span class="p">,</span> <span class="p">[</span> <span class="n">c_I</span><span class="p">,</span> <span class="n">G_I</span><span class="p">,</span> <span class="n">h_I</span><span class="p">,</span> <span class="n">dims_I</span><span class="p">,</span> <span class="n">A_I</span><span class="p">,</span> <span class="n">b_I</span><span class="p">,</span> <span class="n">output</span> <span class="p">])</span> 
        <span class="n">res_12</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">solve</span><span class="p">,[</span><span class="n">c_12</span><span class="p">,</span> <span class="n">G_12</span><span class="p">,</span> <span class="n">h_12</span><span class="p">,</span> <span class="n">dims_12</span><span class="p">,</span> <span class="n">A_12</span><span class="p">,</span> <span class="n">b_12</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
        <span class="n">res_13</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">solve</span><span class="p">,[</span><span class="n">c_13</span><span class="p">,</span> <span class="n">G_13</span><span class="p">,</span> <span class="n">h_13</span><span class="p">,</span> <span class="n">dims_13</span><span class="p">,</span> <span class="n">A_13</span><span class="p">,</span> <span class="n">b_13</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
        <span class="n">res_23</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">solve</span><span class="p">,[</span><span class="n">c_23</span><span class="p">,</span> <span class="n">G_23</span><span class="p">,</span> <span class="n">h_23</span><span class="p">,</span> <span class="n">dims_23</span><span class="p">,</span> <span class="n">A_23</span><span class="p">,</span> <span class="n">b_23</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>

        <span class="c1"># Get the optimal solutions </span>
        <span class="n">retval_I</span><span class="p">,</span> <span class="n">sol_rpq_I</span><span class="p">,</span> <span class="n">sol_slack_I</span><span class="p">,</span> <span class="n">sol_lambda_I</span><span class="p">,</span> <span class="n">sol_mu_I</span><span class="p">,</span> <span class="n">sol_info_I</span> <span class="o">=</span> <span class="n">res_I</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">retval_12</span><span class="p">,</span> <span class="n">sol_rpq_12</span><span class="p">,</span> <span class="n">sol_slack_12</span><span class="p">,</span> <span class="n">sol_lambda_12</span><span class="p">,</span> <span class="n">sol_mu_12</span><span class="p">,</span> <span class="n">sol_info_12</span> <span class="o">=</span> <span class="n">res_12</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">retval_13</span><span class="p">,</span> <span class="n">sol_rpq_13</span><span class="p">,</span> <span class="n">sol_slack_13</span><span class="p">,</span> <span class="n">sol_lambda_13</span><span class="p">,</span> <span class="n">sol_mu_13</span><span class="p">,</span> <span class="n">sol_info_13</span> <span class="o">=</span> <span class="n">res_13</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">retval_23</span><span class="p">,</span> <span class="n">sol_rpq_23</span><span class="p">,</span> <span class="n">sol_slack_23</span><span class="p">,</span> <span class="n">sol_lambda_23</span><span class="p">,</span> <span class="n">sol_mu_23</span><span class="p">,</span> <span class="n">sol_info_23</span> <span class="o">=</span> <span class="n">res_23</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Solve the optimization: min -H( T|XYZ )</span>
        <span class="n">retval_I</span><span class="p">,</span> <span class="n">sol_rpq_I</span><span class="p">,</span> <span class="n">sol_slack_I</span><span class="p">,</span> <span class="n">sol_lambda_I</span><span class="p">,</span> <span class="n">sol_mu_I</span><span class="p">,</span> <span class="n">sol_info_I</span> <span class="o">=</span> <span class="n">subsolver_I</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c_I</span><span class="p">,</span> <span class="n">G_I</span><span class="p">,</span> <span class="n">h_I</span><span class="p">,</span> <span class="n">dims_I</span><span class="p">,</span> <span class="n">A_I</span><span class="p">,</span> <span class="n">b_I</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

        <span class="c1"># Solve the optimizations: min -H( T|XY ), min -H( T|XZ ), min -H( T|YZ )</span>
        <span class="n">retval_12</span><span class="p">,</span> <span class="n">sol_rpq_12</span><span class="p">,</span> <span class="n">sol_slack_12</span><span class="p">,</span> <span class="n">sol_lambda_12</span><span class="p">,</span> <span class="n">sol_mu_12</span><span class="p">,</span> <span class="n">sol_info_12</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c_12</span><span class="p">,</span> <span class="n">G_12</span><span class="p">,</span> <span class="n">h_12</span><span class="p">,</span> <span class="n">dims_12</span><span class="p">,</span> <span class="n">A_12</span><span class="p">,</span> <span class="n">b_12</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">retval_13</span><span class="p">,</span> <span class="n">sol_rpq_13</span><span class="p">,</span> <span class="n">sol_slack_13</span><span class="p">,</span> <span class="n">sol_lambda_13</span><span class="p">,</span> <span class="n">sol_mu_13</span><span class="p">,</span> <span class="n">sol_info_13</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c_13</span><span class="p">,</span> <span class="n">G_13</span><span class="p">,</span> <span class="n">h_13</span><span class="p">,</span> <span class="n">dims_13</span><span class="p">,</span> <span class="n">A_13</span><span class="p">,</span> <span class="n">b_13</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">retval_23</span><span class="p">,</span> <span class="n">sol_rpq_23</span><span class="p">,</span> <span class="n">sol_slack_23</span><span class="p">,</span> <span class="n">sol_lambda_23</span><span class="p">,</span> <span class="n">sol_mu_23</span><span class="p">,</span> <span class="n">sol_info_23</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c_23</span><span class="p">,</span> <span class="n">G_23</span><span class="p">,</span> <span class="n">h_23</span><span class="p">,</span> <span class="n">dims_23</span><span class="p">,</span> <span class="n">A_23</span><span class="p">,</span> <span class="n">b_23</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
    <span class="c1">#^ if parallel</span>

    <span class="c1"># Print warning when  a solution is not returned for any of the optimization</span>
    <span class="k">if</span> <span class="n">retval_I</span> <span class="o">!=</span> <span class="s2">&quot;success&quot;</span> <span class="ow">and</span> <span class="n">retval_12</span> <span class="o">!=</span> <span class="s2">&quot;success&quot;</span> <span class="ow">and</span> <span class="n">retval_13</span> <span class="o">!=</span> <span class="s2">&quot;success&quot;</span> <span class="ow">and</span> <span class="n">retval_23</span> <span class="o">!=</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cone Programming solver failed to find (near) optimal solution.</span><span class="se">\n</span><span class="s2">Please report the input probability density function to abdullah.makkeh@gmail.com</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ecos_keep_solver_obj</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">solver</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MAXENT3D_PID_Exception</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID_Exception: Cone Programming solver failed to find (near) optimal solution. Please report the input probability density function to abdullah.makkeh@gmail.com&quot;</span><span class="p">)</span>
        <span class="c1">#^ if (keep solver)</span>
    <span class="c1">#^ if (solve failure)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Solving is done.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">tic_stats</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Stats for optimizing H(T|X,Y,Z):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sol_info_I</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Stats for optimizing H(T|X,Y):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sol_info_12</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Stats for optimizing H(T|X,Z):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sol_info_13</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Stats for optimizing H(T|Y,Z):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sol_info_23</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">parallel</span> <span class="o">==</span> <span class="s1">&#39;on&#39;</span><span class="p">:</span>

        <span class="c1"># Compute the value of the dual objective function for each optimization:</span>
        <span class="c1"># min -H( T|XYZ ) min -H( T|XY ), min -H( T|XZ ) and  min -H( T|YZ ) ) </span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">()</span>

        <span class="c1"># Call dual_value() to compute the </span>
        <span class="n">dual_I</span>        <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_I</span><span class="o">.</span><span class="n">dual_value</span><span class="p">,[</span><span class="n">sol_lambda_I</span><span class="p">,</span> <span class="n">b_I</span><span class="p">])</span>
        <span class="n">dual_12</span>       <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">dual_value</span><span class="p">,[</span><span class="n">sol_lambda_12</span><span class="p">,</span> <span class="n">b_12</span><span class="p">])</span>
        <span class="n">dual_13</span>       <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">dual_value</span><span class="p">,[</span><span class="n">sol_lambda_13</span><span class="p">,</span> <span class="n">b_13</span><span class="p">])</span>
        <span class="n">dual_23</span>       <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">dual_value</span><span class="p">,[</span><span class="n">sol_lambda_23</span><span class="p">,</span> <span class="n">b_23</span><span class="p">])</span>

        <span class="c1"># Get the dual value</span>
        <span class="n">dual_val_I</span>    <span class="o">=</span> <span class="n">dual_I</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">dual_val_12</span>   <span class="o">=</span> <span class="n">dual_12</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">dual_val_13</span>   <span class="o">=</span> <span class="n">dual_13</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">dual_val_23</span>   <span class="o">=</span> <span class="n">dual_23</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="c1"># Compute the marginals of the optimal pdf (part of the optimal solution is a pdf) </span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">()</span>

        <span class="c1"># Call marginals() </span>
        <span class="n">marg_12</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">marginals</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">sol_rpq_12</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
        <span class="n">marg_13</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">marginals</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">sol_rpq_13</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
        <span class="n">marg_23</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">marginals</span><span class="p">,[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">sol_rpq_23</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>

        <span class="c1"># Get the marginals</span>
        <span class="n">marg_12_T</span><span class="p">,</span> <span class="n">marg_12_X</span><span class="p">,</span> <span class="n">marg_12_Y</span><span class="p">,</span> <span class="n">marg_12_Z</span><span class="p">,</span> <span class="n">marg_12_TX</span><span class="p">,</span> <span class="n">marg_12_TY</span><span class="p">,</span> <span class="n">marg_12_TZ</span><span class="p">,</span> <span class="n">marg_12_XY</span><span class="p">,</span> <span class="n">marg_12_XZ</span><span class="p">,</span> <span class="n">marg_12_YZ</span><span class="p">,</span> <span class="n">marg_12_TXY</span><span class="p">,</span> <span class="n">marg_12_TXZ</span><span class="p">,</span> <span class="n">marg_12_TYZ</span> <span class="o">=</span> <span class="n">marg_12</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">marg_13_T</span><span class="p">,</span> <span class="n">marg_13_X</span><span class="p">,</span> <span class="n">marg_13_Y</span><span class="p">,</span> <span class="n">marg_13_Z</span><span class="p">,</span> <span class="n">marg_13_TX</span><span class="p">,</span> <span class="n">marg_13_TY</span><span class="p">,</span> <span class="n">marg_13_TZ</span><span class="p">,</span> <span class="n">marg_13_XY</span><span class="p">,</span> <span class="n">marg_13_XZ</span><span class="p">,</span> <span class="n">marg_13_YZ</span><span class="p">,</span> <span class="n">marg_13_TXY</span><span class="p">,</span> <span class="n">marg_13_TXZ</span><span class="p">,</span> <span class="n">marg_13_TYZ</span> <span class="o">=</span> <span class="n">marg_13</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">marg_23_T</span><span class="p">,</span> <span class="n">marg_23_X</span><span class="p">,</span> <span class="n">marg_23_Y</span><span class="p">,</span> <span class="n">marg_23_Z</span><span class="p">,</span> <span class="n">marg_23_TX</span><span class="p">,</span> <span class="n">marg_23_TY</span><span class="p">,</span> <span class="n">marg_23_TZ</span><span class="p">,</span> <span class="n">marg_23_XY</span><span class="p">,</span> <span class="n">marg_23_XZ</span><span class="p">,</span> <span class="n">marg_23_YZ</span><span class="p">,</span> <span class="n">marg_23_TXY</span><span class="p">,</span> <span class="n">marg_23_TXZ</span><span class="p">,</span> <span class="n">marg_23_TYZ</span> <span class="o">=</span> <span class="n">marg_23</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>


        <span class="c1"># Compute H(T|X,Y,Z), H(T|X,Y), H(T|X,Z), H(T|Y,Z) (using the optimal pdf) </span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">()</span>

        <span class="c1"># Call condentropy() and condentropy_2vars() </span>
        <span class="n">con_I</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_I</span><span class="o">.</span><span class="n">condentropy</span><span class="p">,[</span><span class="n">sol_rpq_I</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
        <span class="n">con_12</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">condentropy_2vars</span><span class="p">,[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">sol_rpq_12</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">marg_12_XY</span><span class="p">,</span> <span class="n">marg_12_XZ</span><span class="p">,</span> <span class="n">marg_12_YZ</span><span class="p">,</span><span class="n">marg_12_TXY</span><span class="p">,</span> <span class="n">marg_12_TXZ</span><span class="p">,</span> <span class="n">marg_12_TYZ</span><span class="p">])</span>
        <span class="n">con_13</span>        <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">condentropy_2vars</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">sol_rpq_13</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">marg_13_XY</span><span class="p">,</span> <span class="n">marg_13_XZ</span><span class="p">,</span> <span class="n">marg_13_YZ</span><span class="p">,</span> <span class="n">marg_13_TXY</span><span class="p">,</span> <span class="n">marg_13_TXZ</span><span class="p">,</span> <span class="n">marg_13_TYZ</span><span class="p">])</span>
        <span class="n">con_23</span>        <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">condentropy_2vars</span><span class="p">,[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">sol_rpq_23</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">marg_23_XY</span><span class="p">,</span> <span class="n">marg_23_XZ</span><span class="p">,</span> <span class="n">marg_23_YZ</span><span class="p">,</span> <span class="n">marg_23_TXY</span><span class="p">,</span> <span class="n">marg_23_TXZ</span><span class="p">,</span> <span class="n">marg_23_TYZ</span><span class="p">])</span>

        <span class="c1"># Get H(T|X,Y,Z), H(T|X,Y), H(T|X,Z) and H(T|Y,Z)</span>
        <span class="n">condent_I</span>     <span class="o">=</span> <span class="n">con_I</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">condent_12</span>    <span class="o">=</span> <span class="n">con_12</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">condent_13</span>    <span class="o">=</span> <span class="n">con_13</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">condent_23</span>    <span class="o">=</span> <span class="n">con_23</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="c1"># Compute H(T), H(T|X), H(T|Y) and H(T|Z) </span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">()</span>

        <span class="c1"># Call entropy_V() and condent_V()</span>
        <span class="n">ent_T</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">entropy_V</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
        <span class="n">con_1</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">condent_V</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
        <span class="n">con_2</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">condent_V</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
        <span class="n">con_3</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">condent_V</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>

        <span class="c1"># Get H(T), H(T|X), H(T|Y) and H(T|Z) </span>
        <span class="n">entropy_T</span>     <span class="o">=</span> <span class="n">ent_T</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="n">condent_1</span>     <span class="o">=</span> <span class="n">con_1</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">condent_2</span>     <span class="o">=</span> <span class="n">con_2</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">condent_3</span>     <span class="o">=</span> <span class="n">con_3</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="c1"># Compute H(T|X,Y,Z) of the original pdf (not optimal pdf)</span>
        <span class="n">condent__orig</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">condentropy__orig</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="c1"># Compute the value of the dual objective function for each optimization:</span>
        <span class="c1"># min -H( T|XYZ ) min -H( T|XY ), min -H( T|XZ ) and  min -H( T|YZ )</span>
        <span class="n">dual_val_I</span>    <span class="o">=</span> <span class="n">subsolver_I</span><span class="o">.</span><span class="n">dual_value</span><span class="p">(</span><span class="n">sol_lambda_I</span><span class="p">,</span> <span class="n">b_I</span><span class="p">)</span>
        <span class="n">dual_val_12</span>   <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">dual_value</span><span class="p">(</span><span class="n">sol_lambda_12</span><span class="p">,</span> <span class="n">b_12</span><span class="p">)</span>
        <span class="n">dual_val_13</span>   <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">dual_value</span><span class="p">(</span><span class="n">sol_lambda_13</span><span class="p">,</span> <span class="n">b_13</span><span class="p">)</span>
        <span class="n">dual_val_23</span>   <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">dual_value</span><span class="p">(</span><span class="n">sol_lambda_23</span><span class="p">,</span> <span class="n">b_23</span><span class="p">)</span>

        <span class="c1"># Compute the marginals of the optimal pdf (part of the optimal solution is a pdf) </span>
        <span class="n">marg_12_T</span><span class="p">,</span> <span class="n">marg_12_X</span><span class="p">,</span> <span class="n">marg_12_Y</span><span class="p">,</span> <span class="n">marg_12_Z</span><span class="p">,</span> <span class="n">marg_12_TX</span><span class="p">,</span> <span class="n">marg_12_TY</span><span class="p">,</span> <span class="n">marg_12_TZ</span><span class="p">,</span> <span class="n">marg_12_XY</span><span class="p">,</span> <span class="n">marg_12_XZ</span><span class="p">,</span> <span class="n">marg_12_YZ</span><span class="p">,</span> <span class="n">marg_12_TXY</span><span class="p">,</span> <span class="n">marg_12_TXZ</span><span class="p">,</span> <span class="n">marg_12_TYZ</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">marginals</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">sol_rpq_12</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        
        <span class="n">marg_13_T</span><span class="p">,</span> <span class="n">marg_13_X</span><span class="p">,</span> <span class="n">marg_13_Y</span><span class="p">,</span> <span class="n">marg_13_Z</span><span class="p">,</span> <span class="n">marg_13_TX</span><span class="p">,</span> <span class="n">marg_13_TY</span><span class="p">,</span> <span class="n">marg_13_TZ</span><span class="p">,</span> <span class="n">marg_13_XY</span><span class="p">,</span> <span class="n">marg_13_XZ</span><span class="p">,</span> <span class="n">marg_13_YZ</span><span class="p">,</span> <span class="n">marg_13_TXY</span><span class="p">,</span> <span class="n">marg_13_TXZ</span><span class="p">,</span> <span class="n">marg_13_TYZ</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">marginals</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">sol_rpq_13</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

        <span class="n">marg_23_T</span><span class="p">,</span> <span class="n">marg_23_X</span><span class="p">,</span> <span class="n">marg_23_Y</span><span class="p">,</span> <span class="n">marg_23_Z</span><span class="p">,</span> <span class="n">marg_23_TX</span><span class="p">,</span> <span class="n">marg_23_TY</span><span class="p">,</span> <span class="n">marg_23_TZ</span><span class="p">,</span> <span class="n">marg_23_XY</span><span class="p">,</span> <span class="n">marg_23_XZ</span><span class="p">,</span> <span class="n">marg_23_YZ</span><span class="p">,</span> <span class="n">marg_23_TXY</span><span class="p">,</span> <span class="n">marg_23_TXZ</span><span class="p">,</span> <span class="n">marg_23_TYZ</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">marginals</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">sol_rpq_23</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>


        <span class="c1"># Compute H(T|X,Y,Z), H(T|X,Y), H(T|X,Z), H(T|Y,Z) (using the optimal pdf) </span>
        <span class="n">condent_I</span>     <span class="o">=</span> <span class="n">subsolver_I</span><span class="o">.</span><span class="n">condentropy</span><span class="p">(</span><span class="n">sol_rpq_I</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">condent_12</span>    <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">condentropy_2vars</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">sol_rpq_12</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">marg_12_XY</span><span class="p">,</span> <span class="n">marg_12_XZ</span><span class="p">,</span> <span class="n">marg_12_YZ</span><span class="p">,</span><span class="n">marg_12_TXY</span><span class="p">,</span> <span class="n">marg_12_TXZ</span><span class="p">,</span> <span class="n">marg_12_TYZ</span><span class="p">)</span>
        <span class="n">condent_13</span>    <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">condentropy_2vars</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">sol_rpq_13</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">marg_13_XY</span><span class="p">,</span> <span class="n">marg_13_XZ</span><span class="p">,</span> <span class="n">marg_13_YZ</span><span class="p">,</span><span class="n">marg_13_TXY</span><span class="p">,</span> <span class="n">marg_13_TXZ</span><span class="p">,</span> <span class="n">marg_13_TYZ</span><span class="p">)</span>
        <span class="n">condent_23</span>    <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">condentropy_2vars</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">sol_rpq_23</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">marg_23_XY</span><span class="p">,</span> <span class="n">marg_23_XZ</span><span class="p">,</span> <span class="n">marg_23_YZ</span><span class="p">,</span><span class="n">marg_23_TXY</span><span class="p">,</span> <span class="n">marg_23_TXZ</span><span class="p">,</span> <span class="n">marg_23_TYZ</span><span class="p">)</span>

        <span class="c1"># Compute H(T), H(T|X), H(T|Y) and H(T|Z) </span>
        <span class="n">entropy_T</span>     <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">entropy_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">condent_1</span>     <span class="o">=</span> <span class="n">condent_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">condent_2</span>     <span class="o">=</span> <span class="n">condent_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">condent_3</span>     <span class="o">=</span> <span class="n">condent_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

        <span class="c1"># Compute H(T|X,Y,Z) of the original pdf (not optimal pdf) </span>
        <span class="n">condent__orig</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">condentropy__orig</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
    <span class="c1"># elsif cone_solver==&quot;SCS&quot;:</span>
    <span class="c1"># .....</span>
    <span class="c1"># #^endif</span>
    <span class="n">toc_stats</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Time for retrieving results:&quot;</span><span class="p">,</span> <span class="n">toc_stats</span> <span class="o">-</span> <span class="n">tic_stats</span><span class="p">,</span> <span class="s2">&quot;secs</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="n">tic_dict</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Compute the PID quantities  </span>
    <span class="n">return_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">condent_I</span>  <span class="o">-</span> <span class="n">condent__orig</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">condent_23</span> <span class="o">-</span> <span class="n">condent_I</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">condent_13</span> <span class="o">-</span> <span class="n">condent_I</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">condent_12</span> <span class="o">-</span> <span class="n">condent_I</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">condent_I</span>  <span class="o">+</span> <span class="n">condent_3</span>     <span class="o">-</span> <span class="n">condent_13</span>        <span class="o">-</span> <span class="n">condent_23</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">condent_I</span>  <span class="o">+</span> <span class="n">condent_2</span>     <span class="o">-</span> <span class="n">condent_12</span>        <span class="o">-</span> <span class="n">condent_23</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">condent_I</span>  <span class="o">+</span> <span class="n">condent_1</span>     <span class="o">-</span> <span class="n">condent_12</span>        <span class="o">-</span> <span class="n">condent_13</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span>

    <span class="n">tic_o</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>    
    <span class="k">if</span> <span class="n">parallel</span> <span class="o">==</span> <span class="s2">&quot;on&quot;</span><span class="p">:</span>

        <span class="c1"># Compute the feasibility violations of the optimization problems:</span>
        <span class="c1"># min -H( T|XYZ ) min -H( T|XY ), min -H( T|XZ ) and  min -H( T|YZ ) ) </span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">()</span>

        <span class="c1"># Call check_Feasibility()</span>
        <span class="n">feas_I</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_I</span><span class="o">.</span><span class="n">check_feasibility</span><span class="p">,</span> <span class="p">[</span> <span class="n">sol_rpq_I</span><span class="p">,</span><span class="n">sol_lambda_I</span><span class="p">,</span><span class="n">output</span> <span class="p">])</span>

        <span class="n">feas_12</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">check_feasibility</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">sol_rpq_12</span><span class="p">,</span> <span class="n">sol_slack_12</span><span class="p">,</span> <span class="n">sol_lambda_12</span><span class="p">,</span> <span class="n">sol_mu_12</span><span class="p">,</span><span class="n">output</span> <span class="p">])</span>

        <span class="n">feas_13</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">check_feasibility</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">sol_rpq_13</span><span class="p">,</span> <span class="n">sol_slack_13</span><span class="p">,</span> <span class="n">sol_lambda_13</span><span class="p">,</span> <span class="n">sol_mu_13</span><span class="p">,</span><span class="n">output</span> <span class="p">])</span>

        <span class="n">feas_23</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">subsolver_II</span><span class="o">.</span><span class="n">check_feasibility</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">sol_rpq_23</span><span class="p">,</span> <span class="n">sol_slack_23</span><span class="p">,</span> <span class="n">sol_lambda_23</span><span class="p">,</span> <span class="n">sol_mu_23</span><span class="p">,</span><span class="n">output</span> <span class="p">])</span>

        <span class="c1"># Get feasibility violations</span>
        <span class="n">primal_infeas_I</span><span class="p">,</span><span class="n">dual_infeas_I</span> <span class="o">=</span> <span class="n">feas_I</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">primal_infeas_12</span><span class="p">,</span><span class="n">dual_infeas_12</span> <span class="o">=</span> <span class="n">feas_12</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">primal_infeas_13</span><span class="p">,</span><span class="n">dual_infeas_13</span> <span class="o">=</span> <span class="n">feas_13</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">primal_infeas_23</span><span class="p">,</span><span class="n">dual_infeas_23</span> <span class="o">=</span> <span class="n">feas_23</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Compute the feasibility violations of the optimization problems:</span>
        <span class="c1"># min -H( T|XYZ ) min -H( T|XY ), min -H( T|XZ ) and  min -H( T|YZ ) ) </span>

        <span class="n">primal_infeas_I</span><span class="p">,</span><span class="n">dual_infeas_I</span> <span class="o">=</span> <span class="n">subsolver_I</span><span class="o">.</span><span class="n">check_feasibility</span><span class="p">(</span><span class="n">sol_rpq_I</span><span class="p">,</span><span class="n">sol_lambda_I</span><span class="p">,</span><span class="n">output</span><span class="p">)</span>
        

        <span class="n">primal_infeas_12</span><span class="p">,</span><span class="n">dual_infeas_12</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">check_feasibility</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">sol_rpq_12</span><span class="p">,</span> <span class="n">sol_slack_12</span><span class="p">,</span> <span class="n">sol_lambda_12</span><span class="p">,</span> <span class="n">sol_mu_12</span><span class="p">,</span><span class="n">output</span><span class="p">)</span>
        

        <span class="n">primal_infeas_13</span><span class="p">,</span><span class="n">dual_infeas_13</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">check_feasibility</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">sol_rpq_13</span><span class="p">,</span> <span class="n">sol_slack_13</span><span class="p">,</span> <span class="n">sol_lambda_13</span><span class="p">,</span> <span class="n">sol_mu_13</span><span class="p">,</span><span class="n">output</span><span class="p">)</span>
        

        <span class="n">primal_infeas_23</span><span class="p">,</span><span class="n">dual_infeas_23</span> <span class="o">=</span> <span class="n">subsolver_II</span><span class="o">.</span><span class="n">check_feasibility</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">sol_rpq_23</span><span class="p">,</span> <span class="n">sol_slack_23</span><span class="p">,</span> <span class="n">sol_lambda_23</span><span class="p">,</span> <span class="n">sol_mu_23</span><span class="p">,</span><span class="n">output</span><span class="p">)</span>
    <span class="c1">#^if parallel</span>

    <span class="n">toc_o</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Time for computing Numerical Errors:&quot;</span><span class="p">,</span> <span class="n">toc_o</span> <span class="o">-</span> <span class="n">tic_o</span><span class="p">,</span> <span class="s2">&quot;secs</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Store the numerical violations of the optimization problems:</span>
    <span class="c1"># min -H( T|XYZ ) min -H( T|XY ), min -H( T|XZ ) and  min -H( T|YZ ) )</span>
    
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">primal_infeas_I</span><span class="p">,</span> <span class="n">dual_infeas_I</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">condent_I</span><span class="o">*</span><span class="n">ln</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">dual_val_I</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_12&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">primal_infeas_12</span><span class="p">,</span><span class="n">dual_infeas_12</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">condent_12</span><span class="o">*</span><span class="n">ln</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">dual_val_12</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_13&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">primal_infeas_13</span><span class="p">,</span><span class="n">dual_infeas_13</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">condent_13</span><span class="o">*</span><span class="n">ln</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">dual_val_13</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_23&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">primal_infeas_23</span><span class="p">,</span><span class="n">dual_infeas_23</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">condent_23</span><span class="o">*</span><span class="n">ln</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">dual_val_23</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
    <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Solver&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ECOS http://www.embotech.com/ECOS&quot;</span>

    <span class="c1"># Store the model and the problem if asked to </span>
    <span class="k">if</span> <span class="n">ecos_keep_solver_obj</span><span class="p">:</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Ecos Solver Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solver</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Opt I Solver Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subsolver_I</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Opt II Solver Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subsolver_II</span>
        
    <span class="c1">#^ if (keep solver)</span>
    
    <span class="n">toc_dict</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Time for storing results:&quot;</span><span class="p">,</span> <span class="n">toc_dict</span> <span class="o">-</span> <span class="n">tic_dict</span><span class="p">,</span> <span class="s2">&quot;secs</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Recovering Solutions if duality is violated</span>
    <span class="n">which_probs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">gap</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">gap_I</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">gap_12</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">gap_13</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">gap_23</span> <span class="o">=</span> <span class="mf">0.</span>

    <span class="c1"># Determine which problems didn&#39;t converge</span>
    <span class="k">if</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_I&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">1.e-4</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Numerical problems [min - H(T|XYZ)]&quot;</span><span class="p">)</span>
        <span class="n">which_probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">gap_I</span> <span class="o">=</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_I&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_12&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">1.e-4</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Numerical problems [min - H(T|XY)]&quot;</span><span class="p">)</span>
        <span class="n">which_probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">gap_12</span> <span class="o">=</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_12&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_13&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">1.e-4</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Numerical problems [min - H(T|XZ)]&quot;</span><span class="p">)</span>
        <span class="n">which_probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">gap_13</span> <span class="o">=</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_13&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_23&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">1.e-4</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Numerical problems [min - H(T|YZ)]&quot;</span><span class="p">)</span>
        <span class="n">which_probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
        <span class="n">gap_23</span> <span class="o">=</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;Num_err_23&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">which_probs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1">#^ if doesn&#39;t converge</span>
    <span class="n">itic_recover</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
    <span class="c1"># Launch the approperiate QP to recover</span>
    <span class="c1"># if which_probs == []:</span>
    <span class="c1">#     continue </span>
    <span class="n">QP_solver_args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">QP_solver_args</span><span class="p">[</span><span class="s1">&#39;max_iters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="c1"># QP_solver_args[&#39;keep_solver_object&#39;] = True</span>
    <span class="n">QP_solver_args</span><span class="p">[</span><span class="s1">&#39;abstol&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mf">1.e-15</span>
    <span class="n">QP_solver_args</span><span class="p">[</span><span class="s1">&#39;reltol&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mf">1.e-15</span>
    <span class="n">QP_solver_args</span><span class="p">[</span><span class="s1">&#39;feastol&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mf">1.e-15</span>
    <span class="k">if</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>

        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap_12</span> <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_12</span> <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_12</span> <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_12</span> <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap_13</span> <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_13</span> <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_13</span> <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_13</span> <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap_23</span> <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_23</span> <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_23</span> <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_23</span> <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">0.</span>        <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        
    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid():Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">gap</span>  <span class="o">=</span> <span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_12</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        

        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>        

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">gap</span>  <span class="o">=</span> <span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_13</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">23</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">gap</span>  <span class="o">=</span> <span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_23</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>   <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span> <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">gap</span>  <span class="o">=</span> <span class="n">gap_12</span> <span class="o">+</span> <span class="n">gap_13</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>    <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_13</span> <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_12</span> <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_13</span> <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_12</span> <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>    <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">23</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">gap</span>  <span class="o">=</span> <span class="n">gap_12</span> <span class="o">+</span> <span class="n">gap_23</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>    <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_23</span> <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_12</span> <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_23</span> <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>    <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_12</span> <span class="p">)</span>

        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>

        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span><span class="mi">23</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">gap</span>  <span class="o">=</span> <span class="n">gap_13</span> <span class="o">+</span> <span class="n">gap_23</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>    <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_23</span> <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_13</span> <span class="p">)</span> 
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">0.</span>        <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>    <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_23</span> <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap_13</span> <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">gap</span>  <span class="o">=</span> <span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_12</span> <span class="o">+</span> <span class="n">gap_13</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span>            <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>              <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span>            <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_13</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_12</span><span class="p">)</span> <span class="p">)</span> 
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_13</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_12</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>              <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">23</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">gap</span>  <span class="o">=</span> <span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_12</span> <span class="o">+</span> <span class="n">gap_23</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span>            <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>              <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_23</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span>            <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_12</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_23</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>              <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_12</span><span class="p">)</span> <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">23</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">gap</span>  <span class="o">=</span> <span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_13</span> <span class="o">+</span> <span class="n">gap_23</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span>            <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>              <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_23</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_13</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_I</span>            <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>              <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_23</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_I</span> <span class="o">+</span> <span class="n">gap_13</span><span class="p">)</span> <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">which_probs</span> <span class="o">==</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">23</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAXENT3D_PID.pid(): Recovering solution by Quadratic Programming&quot;</span><span class="p">)</span>
        <span class="n">gap</span>  <span class="o">=</span> <span class="n">gap_12</span> <span class="o">+</span> <span class="n">gap_13</span> <span class="o">+</span> <span class="n">gap_23</span>
        <span class="n">CI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;CI&quot;</span><span class="p">],</span>   <span class="mf">0.</span>                   <span class="p">)</span>
        <span class="n">SI</span>   <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">],</span>   <span class="mf">1.</span><span class="o">-</span><span class="n">gap</span>               <span class="p">)</span>
        <span class="n">UIX</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_23</span>            <span class="p">)</span>
        <span class="n">UIY</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_13</span>            <span class="p">)</span>
        <span class="n">UIZ</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">],</span>  <span class="mf">1.</span><span class="o">-</span><span class="n">gap_12</span>            <span class="p">)</span>
        <span class="n">UIXY</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_13</span> <span class="o">+</span> <span class="n">gap_23</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">UIXZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_12</span> <span class="o">+</span> <span class="n">gap_23</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">UIYZ</span> <span class="o">=</span> <span class="p">(</span> <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">],</span> <span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">gap_12</span> <span class="o">+</span> <span class="n">gap_13</span><span class="p">)</span> <span class="p">)</span>
        
        <span class="n">MI</span>  <span class="o">=</span> <span class="n">entropy_T</span>  <span class="o">-</span> <span class="n">condent__orig</span>
        <span class="n">MIX</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIY</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">MIZ</span> <span class="o">=</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
        
        <span class="n">recover_solver</span> <span class="o">=</span> <span class="n">QP</span><span class="p">(</span><span class="n">CI</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">UIX</span><span class="p">,</span><span class="n">UIY</span><span class="p">,</span><span class="n">UIZ</span><span class="p">,</span><span class="n">UIXY</span><span class="p">,</span><span class="n">UIXZ</span><span class="p">,</span><span class="n">UIYZ</span><span class="p">,</span><span class="n">MI</span><span class="p">,</span><span class="n">MIX</span><span class="p">,</span><span class="n">MIY</span><span class="p">,</span><span class="n">MIZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">which_probs</span><span class="p">)</span>
        <span class="n">recover_solver</span><span class="o">.</span><span class="n">ecos_kwargs</span> <span class="o">=</span> <span class="n">QP_solver_args</span>
        <span class="n">retval</span><span class="p">,</span> <span class="n">sol_tx</span><span class="p">,</span> <span class="n">sol_slack</span><span class="p">,</span> <span class="n">sol_lambda</span><span class="p">,</span> <span class="n">sol_mu</span><span class="p">,</span> <span class="n">sol_info</span> <span class="o">=</span> <span class="n">recover_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;SI&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIX&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIY&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIZ&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIXZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">return_data</span><span class="p">[</span><span class="s2">&quot;UIYZ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_tx</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
    <span class="c1">#^ if which problem</span>
    <span class="n">itoc_recover</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">which_probs</span> <span class="o">!=</span> <span class="p">[]</span> <span class="ow">and</span> <span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAXENT3D_PID.pid(): Time to recover solution is:&quot;</span><span class="p">,</span> <span class="n">itoc_recover</span> <span class="o">-</span> <span class="n">itic_recover</span><span class="p">,</span><span class="s2">&quot; secs&quot;</span><span class="p">)</span> 
    <span class="c1"># Sanity check</span>

    <span class="c1">#Check: MI(T; X,Y,Z) = SI + CI + UIX + UIY + UIZ + UIXY + UIXZ + UIYZ</span>
    <span class="n">tol</span>  <span class="o">=</span> <span class="mf">1.e-10</span>
    <span class="n">vio_T_XYZ</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">entropy_T</span> <span class="o">-</span> <span class="n">condent__orig</span>
               <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;CI&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;SI&#39;</span><span class="p">]</span>
               <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIX&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIY&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIZ&#39;</span><span class="p">]</span>
               <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIXY&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIXZ&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIYZ&#39;</span><span class="p">])</span>
    
    <span class="k">assert</span> <span class="n">vio_T_XYZ</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">,</span>                                 <span class="s2">&quot;MAXENT3D_PID.pid(): PID quantities must  sum up to mutual information, the violation is &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">vio_T_XYZ</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;, and the precision is set to &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>

    <span class="c1"># Check: MI(T; X) = SI + UIX + UIXY + UIXZ</span>
    <span class="n">vio_T_X</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
                <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;SI&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIX&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIXY&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIXZ&#39;</span><span class="p">]</span> <span class="p">)</span>
    <span class="k">assert</span> <span class="n">vio_T_X</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">,</span> <span class="s2">&quot;MAXENT3D_PID.pid(): Unique and shared of X must sum up to MI(T; X), the violation is&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">vio_T_X</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; and the precision is set to &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>

    <span class="c1"># Check: MI(T; Y) = SI + UIY + UIXY + UIYZ</span>
    <span class="n">vio_T_Y</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
                <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;SI&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIY&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIXY&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIYZ&#39;</span><span class="p">]</span> <span class="p">)</span>
    
    <span class="k">assert</span> <span class="n">vio_T_Y</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">,</span> <span class="s2">&quot;MAXENT3D_PID.pid(): Unique and shared of Y must sum up to MI(T; Y), and the violation is&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">vio_T_Y</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;, and the precision is set to&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>


    <span class="c1"># Check: MI(T; Z) = SI + UIZ + UIXZ + UIYZ</span>
    <span class="n">vio_T_Z</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">I_V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
                <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;SI&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIZ&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIXZ&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">return_data</span><span class="p">[</span><span class="s1">&#39;UIYZ&#39;</span><span class="p">])</span>
    
    <span class="k">assert</span> <span class="n">vio_T_Z</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">,</span> <span class="s2">&quot;MAXENT3D_PID.pid(): Unique and shared of Z must sum up to MI(S; Z), the violation is&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">vio_T_Z</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;, and the precision is set to&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">return_data</span></div>
<span class="c1">#^ pid()</span>

<span class="c1">#EOF</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Abdullah Makkeh

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>